<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[æ˜Ÿæ™¨å…¥æ¢¦]]></title>
  <link href="http://blog.cxstars.com/atom.xml" rel="self"/>
  <link href="http://blog.cxstars.com/"/>
  <updated>2017-02-24T15:21:30+08:00</updated>
  <id>http://blog.cxstars.com/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://www.mweb.im/">MWeb</generator>
  
  <entry>
    <title type="html"><![CDATA[phpcsé›†æˆgitå·¥ä½œæµ]]></title>
    <link href="http://blog.cxstars.com/14879208825856.html"/>
    <updated>2017-02-24T15:21:22+08:00</updated>
    <id>http://blog.cxstars.com/14879208825856.html</id>
    <content type="html"><![CDATA[
<h3 id="toc_0">git hookä¹‹pre-commit</h3>

<p><em>åœ¨æäº¤ä»£ç å‰è¿›è¡Œä»£ç è§„èŒƒæ£€æŸ¥,å› æ­¤ä½¿ç”¨git hookä¸­çš„pre-commit,ä¸‹é¢æ˜¯pre-commitçš„æ¦‚å¿µ</em></p>

<blockquote>
<p>è¿™ä¸ªé’©å­è¢« <strong>git commit</strong> å‘½ä»¤è°ƒç”¨, è€Œä¸”å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤ä¸­æ·»åŠ <strong>--no-verify</strong> å‚æ•°æ¥è·³è¿‡ã€‚è¿™ä¸ªé’©å­ä¸éœ€è¦å‚æ•°ï¼Œåœ¨å¾—åˆ°æäº¤æ¶ˆæ¯å’Œå¼€å§‹æäº¤(commit)å‰è¢«è°ƒç”¨ã€‚<strong>å¦‚æœé’©å­è¿”å›å€¼ä¸æ˜¯0ï¼Œé‚£ä¹ˆ git commit å‘½ä»¤å°±ä¼šä¸­æ­¢æ‰§è¡Œ</strong>ã€‚</p>
</blockquote>

<h3 id="toc_1">pre-commitä½¿ç”¨</h3>

<p><a href="https://github.com/star1989/phpcs_git"><em>githubæ°¸ä¹…é“¾æ¥,åç»­æ”¹è¿›æ›´æ–°</em></a></p>

<p><em>ä»£ç å®ç°å¦‚ä¸‹</em><br/>
```shell</p>

<h1 id="toc_2">!/bin/bash</h1>

<h1 id="toc_3">check PHP code syntax error and standard with phpcs</h1>

<h1 id="toc_4">author : star[github.com/star1989]</h1>

<h1 id="toc_5">date : 2017-02-24</h1>

<p>PROJECT=\((git rev-parse --show-toplevel)<br/>
cd \)PROJECT<br/>
SFILES=\((git diff --cached --name-only --diff-filter=ACMR HEAD | grep \\.php)<br/>
TMP_DIR=\)PROJECT.&quot;/tmp&quot;</p>

<h1 id="toc_6">Determine if a file list is passed</h1>

<p>if [ &quot;\(#&quot; -ne 0 ]<br/>
then<br/>
    exit 0<br/>
fi<br/>
echo &quot;Checking PHP Lint...&quot;<br/>
for FILE in \)SFILES<br/>
do</p>

<h1 id="toc_7">echo &quot;php -l -d display_errors=0 ${FILE}&quot;</h1>

<h1 id="toc_8">echo &quot;git show :\(FILE &gt; \)TMP_DIR/$FILE&quot;</h1>

<pre><code>php -l -d display_errors=0 $FILE
if [ $? != 0  ]
then
    echo &quot;Fix the error before commit.&quot;
    exit 1
fi
FILES=&quot;$FILES $PROJECT/$FILE&quot;
</code></pre>

<p>done</p>

<p>if [ &quot;$FILES&quot; != &quot;&quot; ]<br/>
then<br/>
    echo &quot;Running Code Sniffer...&quot;</p>

<pre><code>TMP_DIR=/tmp/$(uuidgen)
mkdir -p $TMP_DIR
for FILE in $SFILES
do
    mkdir -p $TMP_DIR/$(dirname $FILE)
    git show :$FILE &gt; $TMP_DIR/$FILE
done
phpcs --standard=PSR2 --encoding=utf-8 -n $TMP_DIR
PHPCS_ERROR=$?
rm -rf $TMP_DIR
if [ $PHPCS_ERROR != 0 ]
then
    echo &quot;Fix the error before commit.&quot;
    exit 1
fi
</code></pre>

<p>fi</p>

<p>exit $?<br/>
```</p>

<h3 id="toc_9">æ•ˆæœ</h3>

<pre><code class="language-shell">#æ­£å¸¸æƒ…å†µ
star@starMBP:~/Documents/web/query-word$ git commit -m &#39;test&#39;
Checking PHP Lint...
No syntax errors detected in public/index.php
No syntax errors detected in public/test.php
Running Code Sniffer...

FILE: ...rivate/tmp/A7518E0C-3C1A-4AB1-80BB-6C2B17F133E9/public/index.php
----------------------------------------------------------------------
FOUND 12 ERRORS AFFECTING 6 LINES
----------------------------------------------------------------------
  6 | ERROR | [ ] Constants must be uppercase; expected
    |       |     &#39;BASEROOTPATH&#39; but found &#39;BaseRootPath&#39;
  9 | ERROR | [x] Expected 1 space after IF keyword; 0 found
 16 | ERROR | [x] Expected 1 space after IF keyword; 0 found
 16 | ERROR | [x] Expected 1 space after closing parenthesis; found 0
 19 | ERROR | [x] Expected 1 space after closing brace; 0 found
 19 | ERROR | [x] Expected 1 space after ELSEIF keyword; 0 found
 19 | ERROR | [x] Expected 1 space after closing parenthesis; found 0
 21 | ERROR | [x] Expected 1 space after closing brace; 0 found
 21 | ERROR | [x] Expected 1 space after ELSEIF keyword; 0 found
 21 | ERROR | [x] Expected 1 space after closing parenthesis; found 0
 23 | ERROR | [x] Expected 1 space after closing brace; 0 found
 23 | ERROR | [x] Expected 1 space after ELSE keyword; 0 found
----------------------------------------------------------------------
PHPCBF CAN FIX THE 11 MARKED SNIFF VIOLATIONS AUTOMATICALLY
----------------------------------------------------------------------

Time: 73ms; Memory: 7.5Mb

Fix the error before commit.

#è·³è¿‡æƒ…å†µ
star@starMBP:~/Documents/web/query-word$ git commit --no-verify -m &#39;test&#39;
[master 3e68145] test
 2 files changed, 3 insertions(+)
 create mode 100644 public/test.php
</code></pre>

<h3 id="toc_10">åç»­</h3>

<p><em>æ—¢ç„¶å¯ä»¥è·³è¿‡,é‚£ä¹ˆå°±ä¸€å®šè¦åœ¨pushæ—¶å†è¡Œæ£€æŸ¥,æ‰€ä»¥å°±å¾—ååˆ°git serviceçš„pre-receive hook</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPerçš„é«˜è´¨é‡ç¼–ç ,ä»£ç è§„èŒƒè‡ªåŠ¨æ£€æŸ¥å·¥ä½œå…·PHP_CodeSniffer]]></title>
    <link href="http://blog.cxstars.com/14879149134068.html"/>
    <updated>2017-02-24T13:41:53+08:00</updated>
    <id>http://blog.cxstars.com/14879149134068.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">å¯¹äºæŠ€æœ¯å’Œä»£ç çš„æ€è€ƒ</h2>

<p>æœ€è¿‘çœ‹åˆ°ä¸€å¥è¯,è§¦åŠ¨é¢‡æ·±:</p>

<blockquote>
<p>è¡ŒåŠ¨ä¸Šçš„å‹¤å‹‰ä¸è¶³ä»¥å¡«è¡¥æ€æƒ³ä¸Šçš„æ‡’æƒ°</p>
</blockquote>

<p>è¯­è¨€æ˜¯é¢å‘å¯¹è±¡çš„,æŠ€æœ¯æ˜¯é¢å‘å•†ä¸šçš„.ä½†è¿™ä¸æ˜¯ä¸€ä¸ªæŠ€æœ¯äººå‘˜åªä¼šå†™ä»£ç çš„ç†ç”±,é‡åˆ°è¿‡å¾ˆå¤šé¢è¯•äººå‘˜å¾€å¾€3,5å¹´ç¼–ç ç»éªŒ,ä¸è¿‡æ›´å¤šçš„æ„Ÿå—æ˜¯ä»–ä»¬åªç”¨äº†3,5ä¸ªæœˆçš„ç»éªŒè¿‡äº†3,5å¹´.</p>

<p>æ‰€ä»¥å¹¶ä¸æ˜¯ä¸€ç›´åœ¨åš,å°±çœŸçš„åšå¥½äº†.æ¥ä¸‹æ¥çš„æ—¥å­,å¸Œæœ›è‡ªå·±èƒ½çœŸæ­£åšå¥½æ¯ä¸€ä»¶äº‹.</p>

<p>å¤šäººåä½œç¼–ç çš„å‰ææ˜¯ç»Ÿä¸€ç¼–ç è§„èŒƒå¹¶æ‰§è¡Œ.é äººå»æ‰§è¡Œ,é äººå»æ£€æŸ¥,å§‹ç»ˆæœ‰é™.æŠ€æœ¯æ”¹å˜ç”Ÿæ´»,å½“ç„¶ä¹ŸåŒ…æ‹¬æŠ€æœ¯äººå‘˜çš„ç”Ÿæ´».</p>

<h2 id="toc_1">PHP_codeSniffer</h2>

<h4 id="toc_2">è¦æ±‚</h4>

<ul>
<li>PHP &gt;= 5.1.2</li>
<li>PHP &gt;= 5.2.4 (ä»…å½“ä½¿ç”¨SVNçš„pre-commitæŒ‚å‹¾)</li>
</ul>

<h4 id="toc_3">å®‰è£…</h4>

<p><em>shell install</em></p>

<pre><code class="language-shell">curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar
php phpcs.phar -h

curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar
php phpcbf.phar -h
</code></pre>

<p><em>pear install</em></p>

<pre><code class="language-shell">pear install PHP_CodeSniffer
</code></pre>

<p><em>composer install</em></p>

<pre><code class="language-shell">commandæ–¹å¼
composer global require &quot;squizlabs/php_codesniffer=*&quot;

compser.jsonæ–¹å¼
{
    &quot;require-dev&quot;: {
        &quot;squizlabs/php_codesniffer&quot;: &quot;2.*&quot;
    }
}
</code></pre>

<span id="more"></span><!-- more -->

<h4 id="toc_4">phpcsä½¿ç”¨</h4>

<p><em>phpcsçš„æ‰€æœ‰å‚æ•°å’Œè¯´æ˜</em></p>

<pre><code class="language-shell">star@starMBP:~$ phpcs -h
Usage: phpcs [-nwlsaepqvi] [-d key[=value]] [--colors] [--no-colors] [--stdin-path=&lt;stdinPath&gt;]
    [--report=&lt;report&gt;] [--report-file=&lt;reportFile&gt;] [--report-&lt;report&gt;=&lt;reportFile&gt;] ...
    [--report-width=&lt;reportWidth&gt;] [--generator=&lt;generator&gt;] [--tab-width=&lt;tabWidth&gt;]
    [--severity=&lt;severity&gt;] [--error-severity=&lt;severity&gt;] [--warning-severity=&lt;severity&gt;]
    [--runtime-set key value] [--config-set key value] [--config-delete key] [--config-show]
    [--standard=&lt;standard&gt;] [--sniffs=&lt;sniffs&gt;] [--exclude=&lt;sniffs&gt;] [--encoding=&lt;encoding&gt;]
    [--extensions=&lt;extensions&gt;] [--ignore=&lt;patterns&gt;] [--bootstrap=&lt;bootstrap&gt;]
    [--file-list=&lt;fileList&gt;] &lt;file&gt; ...
                      Set runtime value (see --config-set)
        -n            Do not print warnings (shortcut for --warning-severity=0)
        -w            Print both warnings and errors (this is the default)
        -l            Local directory only, no recursion
        -s            Show sniff codes in all reports
        -a            Run interactively
        -e            Explain a standard by showing the sniffs it includes
        -p            Show progress of the run
        -q            Quiet mode; disables progress and verbose output
        -v[v][v]      Print verbose output
        -i            Show a list of installed coding standards
        -d            Set the [key] php.ini value to [value] or [true] if value is omitted
        --help        Print this help message
        --version     Print version information
        --colors      Use colors in output
        --no-colors   Do not use colors in output (this is the default)
        &lt;file&gt;        One or more files and/or directories to check
        &lt;fileList&gt;    A file containing a list of files and/or directories to check (one per line)
        &lt;stdinPath&gt;   If processing STDIN, the file path that STDIN will be processed as
        &lt;bootstrap&gt;   A comma separated list of files to run before processing starts
        &lt;encoding&gt;    The encoding of the files being checked (default is iso-8859-1)
        &lt;extensions&gt;  A comma separated list of file extensions to check
                      (extension filtering only valid when checking a directory)
                      The type of the file can be specified using: ext/type
                      e.g., module/php,es/js
        &lt;generator&gt;   Uses either the &quot;HTML&quot;, &quot;Markdown&quot; or &quot;Text&quot; generator
                      (forces documentation generation instead of checking)
        &lt;patterns&gt;    A comma separated list of patterns to ignore files and directories
        &lt;report&gt;      Print either the &quot;full&quot;, &quot;xml&quot;, &quot;checkstyle&quot;, &quot;csv&quot;
                      &quot;json&quot;, &quot;emacs&quot;, &quot;source&quot;, &quot;summary&quot;, &quot;diff&quot;, &quot;junit&quot;
                      &quot;svnblame&quot;, &quot;gitblame&quot;, &quot;hgblame&quot; or &quot;notifysend&quot; report
                      (the &quot;full&quot; report is printed by default)
        &lt;reportFile&gt;  Write the report to the specified file path
        &lt;reportWidth&gt; How many columns wide screen reports should be printed
                      or set to &quot;auto&quot; to use current screen width, where supported
        &lt;sniffs&gt;      A comma separated list of sniff codes to include or exclude during checking
                      (all sniffs must be part of the specified standard)
        &lt;severity&gt;    The minimum severity required to display an error or warning
        &lt;standard&gt;    The name or path of the coding standard to use
        &lt;tabWidth&gt;    The number of spaces each tab represents
</code></pre>

<p><em>æŸ¥çœ‹å½“å‰æ ‡å‡†</em></p>

<pre><code class="language-shell">star@starMBP:~$ phpcs -i
The installed coding standards are MySource, PEAR, PHPCS, PSR1, PSR2, Squiz and Zend
</code></pre>

<p><em>å¿½ç•¥warning(å¦‚ä¸€è¡Œè¶…è¿‡85ä¸ªå­—ç¬¦ä¼šæŠ¥warning,ä¸å¼ºåˆ¶,å»ºè®®å…³æ‰)</em></p>

<pre><code class="language-shell">#å‚æ•°å‘½ä»¤
phpcs -n your_file
#ç¯å¢ƒå‘½ä»¤
phpcs --config-set show_warnings 0
</code></pre>

<p><em>è®¾ç½®é»˜è®¤æ ‡å‡†</em></p>

<blockquote>
<p>By default, PHP_CodeSniffer will use the PEAR coding standard if no standard is supplied on the command line. </p>
</blockquote>

<pre><code class="language-shell">star@starMBP:~$ phpcs --config-set default_standard PSR2
Config value &quot;default_standard&quot; added successfully
</code></pre>

<p><em>è®¾ç½®ç»ˆç«¯é¢œè‰²è¾“å‡º</em></p>

<pre><code>phpcs --config-set colors 1
</code></pre>

<p><em>è®¾ç½®æ–‡ä»¶ç¼–ç æ ‡å‡†</em></p>

<blockquote>
<p>By default, PHP_CodeSniffer will treat all source files as if they use ISO-8859-1 encoding. This can cause double-encoding problems when generating UTF-8 encoded XML reports</p>
</blockquote>

<pre><code class="language-shell">phpcs --config-set encoding utf-8
</code></pre>

<p><em>åŠ è½½è‡ªå®šä¹‰ç¼–ç </em></p>

<pre><code class="language-shell">phpcs --config-set installed_paths your_standard_path
</code></pre>

<p><em>æ£€æŸ¥PHPæ–‡ä»¶</em></p>

<pre><code class="language-shell">star@starMBP:~$ phpcs sample.php
FOUND 43 ERRORS AFFECTING 33 LINES
----------------------------------------------------------------------
   3 | ERROR | [ ] Each class must be in a namespace of at least one
     |       |     level (a top-level vendor name)
   3 | ERROR | [x] Opening brace of a class must be on the line after
     |       |     the definition
   5 | ERROR | [x] Opening brace should be on a new line
  23 | ERROR | [x] Expected 1 space after IF keyword; 0 found
  ........
----------------------------------------------------------------------
PHPCBF CAN FIX THE 42 MARKED SNIFF VIOLATIONS AUTOMATICALLY
----------------------------------------------------------------------

Time: 633ms; Memory: 22.75Mb
</code></pre>

<p><strong>åœ¨è¿™é‡Œå…¶å®å·²ç»æåˆ°äº†ä¸‹ä¸€æ­¥è¦åšä»€ä¹ˆäº†,ä½¿ç”¨PHPCBFä¿®å¤</strong></p>

<p><em>phpcbfä¿®å¤</em></p>

<pre><code class="language-shell">star@starMBP:~$ phpcbf sample.php
Changing into directory /Users/star/sample.php
Processing sample.php [PHP =&gt; 4751 tokens in 449 lines]... DONE in 555ms (42 fixable violations)
        =&gt; Fixing file: 0/42 violations remaining [made 3 passes]... DONE in 1.98 secs
Patched 1 file
Time: 2.65 secs; Memory: 36.5Mb
</code></pre>

<h4 id="toc_5">å‚è€ƒ</h4>

<p><a href="https://github.com/squizlabs/PHP_CodeSniffer/wiki">CodeSniffer_wiki</a><br/>
<a href="https://pear.php.net/manual/en/package.php.php-codesniffer.coding-standard-tutorial.php">Coding Standard Tutorial</a></p>

<h2 id="toc_6">åç»­</h2>

<p>ç»§ç»­æ€è€ƒ,æ€æ ·æ›´é«˜æ•ˆæ›´åŠ ç¬¦åˆæŠ€æœ¯æµç¨‹.</p>

<p>åç»­ä½¿ç”¨gitçš„åšæäº¤å‰çš„ä»£ç æ ¼å¼åŒ–,å¹¶ä½¿ç”¨jenkinsåšæŒç»­é›†æˆ.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[intl,geoip,mongodbæ‰©å±•macoså®‰è£…è¸©å‘]]></title>
    <link href="http://blog.cxstars.com/14878474870577.html"/>
    <updated>2017-02-23T18:58:07+08:00</updated>
    <id>http://blog.cxstars.com/14878474870577.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">æ‰©å±•ç»„ä»¶</h2>

<ul>
<li><a href="http://pecl.php.net/package/geoip">geoip</a></li>
<li>intl</li>
<li><a href="http://pecl.php.net/package/imagick">imagick</a></li>
<li><a href="http://php.net/manual/zh/mongodb.installation.manual.php">mongodb</a></li>
</ul>

<h2 id="toc_1">intl</h2>

<h4 id="toc_2">é”™è¯¯</h4>

<pre><code class="language-shell">configure: error: Unable to detect ICU prefix or no failed. Please verify ICU install prefix and make sure icu-config works.
</code></pre>

<p><strong>è§£å†³</strong></p>

<pre><code class="language-shell">brew install --force icu4c
pecl install intl
è¾“å…¥icu4cè·¯å¾„:/usr/local/opt/icu4c

Build process completed successfully
Installing &#39;/usr/local/php/lib/php/extensions/debug-zts-20131226/intl.so&#39;
install ok: channel://pecl.php.net/intl-3.0.0
configuration option &quot;php_ini&quot; is not set to php.ini location
You should add &quot;extension=intl.so&quot; to php.ini
</code></pre>

<h2 id="toc_3">geoIP</h2>

<h4 id="toc_4">é”™è¯¯</h4>

<pre><code class="language-shell">checking for geoip files in default path... not found
configure: error: Please reinstall the geoip distribution
</code></pre>

<p><strong>è§£å†³</strong></p>

<pre><code class="language-shell">curl -O http://www.maxmind.com/download/geoip/api/c/GeoIP-latest.tar.gz
tar -zxf GeoIP-latest.tar.gz
cd GeoIP-1.6.0/
./configure --prefix=/Users/star/Documents/geo
make &amp;&amp; make install

cd ../geoip-1.0.8
phpize
vim configure
åœ¨4102è¡Œæ·»åŠ ä¸Šé¢çš„åº“PATH
 4101   # --with-geoip -&gt; check with-path
 4102   SEARCH_PATH=&quot;/usr/local /usr /sw /opt/local /Users/star/Documents/geo&quot;
 4103   SEARCH_FOR=&quot;/include/GeoIP.h&quot;
 4104   if test -r $PHP_GEOIP/$SEARCH_FOR; then
 4105     GEOIP_DIR=$PHP_GEOIP
 4106   else # search default path list
 4107     { $as_echo &quot;$as_me:${as_lineno-$LINENO}: checking for geoip files in default path&quot; &gt;&amp;5
 4108 $as_echo_n &quot;checking for geoip files in default path... &quot; &gt;&amp;6; }
 4109     for i in $SEARCH_PATH ; do
 4110       if test -r $i/$SEARCH_FOR; then
 4111         GEOIP_DIR=$i
 4112         { $as_echo &quot;$as_me:${as_lineno-$LINENO}: result: found in $i&quot; &gt;&amp;5
 4113 $as_echo &quot;found in $i&quot; &gt;&amp;6; }
 4114       fi
 4115     done
 4116   fi
 ./configure --with-php-config=/usr/local/php/bin/php-config
 make
 make install
</code></pre>

<h4 id="toc_5">é”™è¯¯</h4>

<p><code>GeoIPCity.dat Not Found</code></p>

<p><strong>è§£å†³</strong></p>

<pre><code class="language-shell">curl -O http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz
gunzip GeoLiteCity.dat.gz
mv GeoLiteCity.dat /Users/star/Documents/geo/share/GeoIP/
</code></pre>

<h2 id="toc_6">mongoDB</h2>

<h4 id="toc_7">é”™è¯¯</h4>

<p><code>makeæ—¶é”™è¯¯ opensslå¤´æ–‡ä»¶æ‰¾ä¸åˆ°</code></p>

<p><strong>è§£å†³</strong></p>

<pre><code class="language-shell">ln -s /usr/local/opt/openssl/include/openssl /usr/local/include/
</code></pre>

<h2 id="toc_8">imagick</h2>

<p><code>pecl install imagick</code></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPæ‰©å±•åŸºç¡€çŸ¥è¯†åŠç”Ÿæˆ]]></title>
    <link href="http://blog.cxstars.com/14873400340656.html"/>
    <updated>2017-02-17T22:00:34+08:00</updated>
    <id>http://blog.cxstars.com/14873400340656.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">æ‰©å±•çŸ¥è¯†</h2>

<h3 id="toc_1">PHPæ¶æ„å›¾</h3>

<p><img src="http://bimg.cxstars.com/2017-02-15-14871384652088.jpg" alt="PHPæ¶æ„å›¾"/></p>

<h3 id="toc_2">PHPæ¡†æ¶ç”Ÿæˆå™¨</h3>

<pre><code class="language-shell">star@starMBP:~/Documents/images/php/php-5.6.22/ext$ ls
ext_skel
ext_skel_win32.php
</code></pre>

<p><strong>ç”Ÿæˆå™¨ä½¿ç”¨æ–¹æ³•</strong></p>

<pre><code class="language-shell">./ext_skel --extname=module [--proto=file] [--stubs=file] [--xml[=file]]
           [--skel=dir] [--full-xml] [--no-help]

  --extname=module   module is the name of your extension
  --proto=file       file contains prototypes of functions to create
  --stubs=file       generate only function stubs in file
  --xml              generate xml documentation to be added to phpdoc-svn
  --skel=dir         path to the skeleton directory
  --full-xml         generate xml documentation for a self-contained extension
                     (not yet implemented)
  --no-help          don&#39;t try to be nice and create comments in the code
                     and helper functions to test if the module compiled
</code></pre>

<h3 id="toc_3">æ¡†æ¶æ–‡ä»¶ç»“æ„</h3>

<pre><code class="language-shell">star@starMBP:~/Documents/images/php/php-5.6.22/ext$ ls star_test/
CREDITS         config.m4       php_star_test.h star_test.php
EXPERIMENTAL    config.w32      star_test.c     tests
</code></pre>

<h4 id="toc_4">config.m4</h4>

<blockquote>
<p><em>config.m4</em> æ–‡ä»¶å‘Šè¯‰ UNIX æ„å»ºç³»ç»Ÿå“ªäº›æ‰©å±• configure é€‰é¡¹æ˜¯æ”¯æŒçš„ï¼Œä½ éœ€è¦å“ªäº›æ‰©å±•åº“ï¼Œä»¥åŠå“ªäº›æºæ–‡ä»¶è¦ç¼–è¯‘æˆå®ƒçš„ä¸€éƒ¨åˆ†ã€‚</p>

<p><em>config.m4</em> æ–‡ä»¶ä½¿ç”¨ <strong>GNU autoconf</strong> è¯­æ³•ç¼–å†™ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ç”¨å¼ºå¤§çš„å®è¯­è¨€å¢å¼ºçš„ shell è„šæœ¬ã€‚æ³¨é‡Šç”¨å­—ç¬¦ä¸² <strong>dnl</strong> åˆ†éš”ï¼Œå­—ç¬¦ä¸²åˆ™æ”¾åœ¨å·¦å³æ–¹æ‹¬å·ä¸­é—´ï¼ˆä¾‹å¦‚ï¼Œ[ å’Œ ]ï¼‰ã€‚å­—ç¬¦ä¸²å¯æŒ‰éœ€è¦å¤šæ¬¡åµŒå¥—å¼•ç”¨ã€‚</p>
</blockquote>

<h4 id="toc_5">PHP_ARG_*: èµ‹äºˆç”¨æˆ·å¯é€‰é¡¹</h4>

<blockquote>
<p><strong>PHP_ARG_WITH()</strong> ç”¨äºå–å¾—å‚æ•°çš„é€‰é¡¹ï¼Œä¾‹å¦‚æ‰©å±•æ‰€éœ€åº“æˆ–ç¨‹åºçš„ä½ç½®<br/>
<strong>PHP_ARG_ENABLE()</strong> ç”¨äºä»£è¡¨ç®€å•æ ‡å¿—çš„é€‰é¡¹ã€‚</p>
</blockquote>

<pre><code class="language-shell">$ ./configure --with-example=/some/library/path/example-config --disable-example-debug --with-example-extra=/another/library/path
...
checking for example support... yes
checking whether to enable debugging support in example... no
checking for extra libraries for example... /another/library/path
...

PHP_ARG_WITH(example, for example support,
[  --with-example[=FILE]       Include example support. File is the optional path to example-config])
PHP_ARG_ENABLE(example-debug, whether to enable debugging support in example,
[  --enable-example-debug        example: Enable debugging support in example], no, no)
PHP_ARG_WITH(example-extra, for extra libraries for example,
[  --with-example-extra=DIR      example: Location of extra libraries for example], no, no)

dnl æ£€æµ‹æ‰©å±•æ˜¯å¦å·²å¯ç”¨
if test &quot;$PHP_EXAMPLE&quot; != &quot;no&quot;; then
  
  dnl æ£€æµ‹ example-configã€‚é¦–å…ˆå°è¯•æ‰€ç»™å‡ºçš„è·¯å¾„ï¼Œç„¶ååœ¨ $PATH ä¸­å¯»æ‰¾
  AC_MSG_CHECKING([for example-config])
  EXAMPLE_CONFIG=&quot;example-config&quot;
  if test &quot;$PHP_EXAMPLE&quot; != &quot;yes&quot;; then
    EXAMPLE_PATH=$PHP_EXAMPLE
  else
    EXAMPLE_PATH=`$php_shtool path $EXAMPLE_CONFIG`
  fi
  
  dnl å¦‚æœæ‰¾åˆ°å¯ç”¨çš„ example-configï¼Œå°±ä½¿ç”¨å®ƒ
  if test -f &quot;$EXAMPLE_PATH&quot; &amp;&amp; test -x &quot;$EXAMPLE_PATH&quot; &amp;&amp; $EXAMPLE_PATH --version &gt; /dev/null 2&gt;&amp;1; then
    AC_MSG_RESULT([$EXAMPLE_PATH])
    EXAMPLE_LIB_NAME=`$EXAMPLE_PATH --libname`
    EXAMPLE_INCDIRS=`$EXAMPLE_PATH --incdirs`
    EXAMPLE_LIBS=`$EXAMPLE_PATH --libs`
    
    dnl æ£€æµ‹æ‰©å±•åº“æ˜¯å¦å·¥ä½œæ­£å¸¸
    PHP_CHECK_LIBRARY($EXAMPLE_LIB_NAME, example_critical_function,
    [
      dnl æ·»åŠ æ‰€éœ€çš„ include ç›®å½•
      PHP_EVAL_INCLINE($EXAMPLE_INCDIRS)
      dnl æ·»åŠ æ‰€éœ€çš„æ‰©å±•åº“åŠæ‰©å±•åº“æ‰€åœ¨ç›®å½•
      PHP_EVAL_LIBLINE($EXAMPLE_LIBS, EXAMPLE_SHARED_LIBADD)
    ],[
      dnl è·³å‡º
      AC_MSG_ERROR([example library not found. Check config.log for more information.])
    ],[$EXAMPLE_LIBS]
    )
  else
    dnl æ²¡æœ‰å¯ç”¨çš„ example-configï¼Œè·³å‡º
    AC_MSG_RESULT([not found])
    AC_MSG_ERROR([Please check your example installation.])
  fi
  
  dnl æ£€æµ‹æ˜¯å¦å¯ç”¨è°ƒè¯•
  if test &quot;$PHP_EXAMPLE_DEBUG&quot; != &quot;no&quot;; then
    dnl æ˜¯ï¼Œåˆ™è®¾ç½® C è¯­è¨€å®æŒ‡ä»¤
    AC_DEFINE(USE_EXAMPLE_DEBUG,1,[Include debugging support in example])
  fi
  
  dnl æ£€æµ‹é¢å¤–çš„æ”¯æŒ
  if test &quot;$PHP_EXAMPLE_EXTRA&quot; != &quot;no&quot;; then
    if test &quot;$PHP_EXAMPLE_EXTRA&quot; == &quot;yes&quot;; then
      AC_MSG_ERROR([You must specify a path when using --with-example-extra])
    fi
    
    PHP_CHECK_LIBRARY(example-extra, example_critical_extra_function,
    [
      dnl æ·»åŠ æ‰€éœ€è·¯å¾„
      PHP_ADD_INCLUDE($PHP_EXAMPLE_EXTRA/include)
      PHP_ADD_LIBRARY_WITH_PATH(example-extra, $PHP_EXAMPLE_EXTRA/lib, EXAMPLE_SHARED_LIBADD)
      AC_DEFINE(HAVE_EXAMPLEEXTRALIB,1,[Whether example-extra support is present and requested])
      EXAMPLE_SOURCES=&quot;$EXAMPLE_SOURCES example_extra.c&quot;
    ],[
      AC_MSG_ERROR([example-extra lib not found. See config.log for more information.])
    ],[-L$PHP_EXAMPLE_EXTRA/lib]
    )
  fi
  
  dnl æœ€åï¼Œå°†æ‰©å±•åŠå…¶æ‰€éœ€æ–‡ä»¶ç­‰ä¿¡æ¯ä¼ ç»™æ„å»ºç³»ç»Ÿ
  PHP_NEW_EXTENSION(example, example.c $EXAMPLE_SOURCES, $ext_shared)
  PHP_SUBST(EXAMPLE_SHARED_LIBADD)
fi
</code></pre>

<h2 id="toc_6">ç”Ÿæˆæ‰©å±•</h2>

<pre><code class="language-shell">star@starMBP:~/Documents/images/php/php-5.6.22/ext$ ./ext_skel --extname=star_queue
Creating directory star_queue
Creating basic files: config.m4 config.w32 .gitignore star_queue.c php_star_queue.h CREDITS EXPERIMENTAL tests/001.phpt star_queue.php [done].

To use your new extension, you will have to execute the following steps:

1.  $ cd ..
2.  $ vi ext/star_queue/config.m4
3.  $ ./buildconf
4.  $ ./configure --[with|enable]-star_queue
5.  $ make
6.  $ ./sapi/cli/php -f ext/star_queue/star_queue.php
7.  $ vi ext/star_queue/star_queue.c
8.  $ make

Repeat steps 3-6 until you are satisfied with ext/star_queue/config.m4 and
step 6 confirms that your module is compiled into PHP. Then, start writing
code and repeat the last two steps as often as necessary.
</code></pre>

<h2 id="toc_7">ä¿®æ”¹config.m4</h2>

<pre><code class="language-c"> 16 PHP_ARG_ENABLE(star_queue, whether to enable star_queue support,
 17 Make sure that the comment is aligned:
 18 [  --enable-star_queue           Enable star_queue support])
</code></pre>

<h2 id="toc_8">ç¼–è¯‘</h2>

<pre><code class="language-shell">phpize
./configure --with-php-config=/your php-config path
make
make install
</code></pre>

<p>æŸ¥çœ‹æ‰©å±•<br/>
<code>ls /usr/local/php/lib/php/extensions/debug-zts-20131226/</code></p>

<pre><code class="language-shell">star_queue.so
</code></pre>

<h2 id="toc_9">æµ‹è¯•æ‰©å±•</h2>

<p><code>php -f star_queue.php</code></p>

<pre><code class="language-shell">star@starMBP:~/Documents/images/php/php-5.6.22/ext/star_queue$ php -f star_queue.php
Functions available in the test extension:
queue_new
queue_push
queue_pop
queue_count
confirm_star_queue_compiled

Congratulations! You have successfully modified ext/star_queue/config.m4. Module star_queue is now compiled into PHP.
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[è®¡ç®—æœºç¼–ç ä¸pythonç¼–ç ]]></title>
    <link href="http://blog.cxstars.com/14850124799483.html"/>
    <updated>2017-01-21T23:27:59+08:00</updated>
    <id>http://blog.cxstars.com/14850124799483.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">ç¼–ç </h2>

<h3 id="toc_1">ASCII</h3>

<blockquote>
<p>è®¡ç®—æœºå‘æ˜æ—¶,ç¾å›½äººåªè€ƒè™‘äº†è‹±è¯­,æ‰€ä»¥å½“æ—¶çš„ASCIIç¼–ç åªæœ‰8ä¸ªæ¯”ç‰¹,å³1ä¸ªå­—èŠ‚.å¤§å°è‹±æ–‡å­—æ¯/æ•°å­—/æ ‡ç‚¹ç¬¦å·/ç‰¹æ®Šç¬¦å·ç­‰127ä¸ªå­—æ¯è¢«çº³å…¥å¹¶è§„èŒƒæˆäº†ASCIIç¼–ç .</p>
</blockquote>

<h3 id="toc_2">Unicode(Universal Multiple-Octet Coded Character Set)</h3>

<blockquote>
<p>ASCIIç¼–ç åªé€‚ç”¨äºè‹±è¯­å›½å®¶,æ‰€ä»¥åæ¥ç™¾å®¶äº‰é¸£,ä¸­å›½æœ‰<strong>GB2312</strong>ç¼–ç ,éŸ©å›½/æ—¥æœ¬ç­‰ä¹Ÿéƒ½è‡ªåˆ¶ç¼–ç .å°±è¿™æ ·,å†²çªæ¥äº†.<br/>
ä¸ºäº†è§£å†³å†²çª,Unicodeç¼–ç è¢«åå•†åˆ¶å®šå‡ºæ¥.å°†ä¸–ç•Œä¸Šæ‰€æœ‰è¯­è¨€å­—ç¬¦éƒ½ç¼–ç æˆä¸€ä¸ªæ•°å­—.<br/>
Unicodeå­—ç¬¦ç æ˜¯32ä½ï¼Œ4ä¸ªå­—èŠ‚ã€‚</p>
</blockquote>

<h3 id="toc_3">UTF-8</h3>

<blockquote>
<p>Unicodeç¼–ç è™½ç„¶å…¼å®¹ASCII,ä½†æ˜¯ä¼šäº§ç”Ÿæå¤§çš„æµªè´¹,Doubleäº†.æ‰€ä»¥æ‰å‡ºç°äº†æŠŠUnicodeç¼–ç è½¬åŒ–ä¸º<em>å¯å˜é•¿ç¼–ç </em>çš„UTF-8ç¼–ç .UTF-8ç¼–ç æ°¢ä¸€ä¸ªUnicodeå­—ç¬¦æ ¹æ®ä¸åŒçš„æ•°å­—å¤§å°ç¼–ç æˆ1-6ä¸ªå­—èŠ‚.è‹±æ–‡å­—æ¯1ä¸ªå­—èŠ‚,æ±‰å­—é€šå¸¸3å­—èŠ‚,ç”Ÿåƒ»å­—4-6å­—èŠ‚.<br/>
ä¸€èˆ¬æƒ…å†µå‡ä¼ è¾“çš„æ˜¯è‹±æ–‡å­—æ¯(éƒ½æ˜¯ä»£ç ).</p>
</blockquote>

<h2 id="toc_4">è®¡ç®—æœºå†…å­˜ç¼–ç </h2>

<blockquote>
<p>æ—©æœŸUnicodeç¼–ç å°±æ˜¯16ä½2å­—èŠ‚å®šé•¿.ä½†æ˜¯ä¸­å›½æ–‡åŒ–5åƒå¹´,æ–‡å­—å¤ªå¤š,å±…ç„¶è¶…è¿‡äº†65536ä¸ª.So,Unicodeå°±ä»å®šé•¿èµ°å‘äº†ä¸å®šé•¿çš„é“è·¯.<br/>
è®¡ç®—æœºå¤„ç†æ–‡æœ¬çš„æ—¶å€™ï¼Œå†…å­˜ä¸­ä¸€èˆ¬éƒ½ä¸ç”¨UTF-8ã€‚å› ä¸ºUTF-8æ˜¯å˜é•¿ç¼–ç ï¼Œä¸ä»å¤´æ‰«æä¸€éï¼Œä½ ä¸çŸ¥é“ç¬¬å‡ ä¸ªå­—ç¬¦åœ¨å“ªä¸ªä½ç½®ä¸Šï¼Œè¿™åœ¨å¤„ç†çš„æ—¶å€™éå¸¸æµªè´¹æ—¶é—´ã€‚ç°åœ¨å¾ˆå¤šè¯­è¨€/ç¨‹åºçš„å¤„ç†åŠæ³•ï¼Œæ˜¯ä½¿ç”¨æºäºåŸå§‹UTF-16çš„ä¸€ä¸ªå®šé•¿ç¼–ç ï¼Œåªå¤„ç†å­—ç¬¦ç åœ¨16ä½ä»¥å†…çš„å­—ç¬¦ï¼Œä¸æ”¯æŒè¶…è¿‡16ä½çš„ç½•è§å­—ã€‚è¿™ç§16ä½å®šé•¿çš„ç¼–ç æ–¹å¼è¢«ç§°ä¸ºUCS-2ã€‚é‚£äº›é›¶æ˜Ÿçš„å‡ ä¸ªçªç ´16ä½çš„å­—ç¬¦ï¼Œé™¤éä½ ä¸“é—¨ç ”ç©¶å¤æ–‡æˆ–è€…å¥‡æ€ªçš„å°è¯­ç§ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯é‡ä¸åˆ°çš„ã€‚é‡åˆ°äº†ä¹Ÿæ˜¯é»‘äººé—®å·è„¸ã€‚<br/>
è§£å†³åŠæ³•:ä¸æ€•æµªè´¹ç©ºé—´çš„ï¼Œå°±ç”¨UTF-32ï¼Œä¸æ€•æµªè´¹å¤„ç†æ—¶é—´çš„ï¼Œå°±ç”¨å®Œæ•´çš„UTF-16ï¼Œæˆ–è€…ç´¢æ€§ç”¨UTF-8ã€‚</p>
</blockquote>

<h2 id="toc_5">pythonç¼–ç </h2>

<p>åœ¨python2ä¸­,<code>&#39;xxx&#39;</code>å’Œ<code>u&#39;xxx&#39;</code>æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„.å‰è€…æ˜¯UTF-8ç¼–ç çš„,ä¹ŸåŒASCIIç¼–ç ,åè€…æ˜¯Unicodeç¼–ç .<br/>
Unicodeè½¬UTF-8ç¼–ç :<br/>
<code>u&#39;aaa&#39;.encode(&#39;utf-8&#39;)</code><br/>
UTF-8è½¬Unicodeç¼–ç :<br/>
<code>&#39;ä¸­å›½&#39;.decode(&#39;utf-8&#39;)</code><br/>
è¾“å…¥ä¸­æ–‡ç¼–ç å‰æ:<br/>
<code># -*- coding: utf-8 -*-</code></p>

<p>åœ¨python3ä¸­,<code>&#39;xxx&#39;</code>å’Œ<code>u&#39;xxx&#39;</code>éƒ½æ˜¯Unicodeç¼–ç .</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ä½¿ç”¨pythonæ­å»ºssæ¢¯å­]]></title>
    <link href="http://blog.cxstars.com/14848778197605.html"/>
    <updated>2017-01-20T10:03:39+08:00</updated>
    <id>http://blog.cxstars.com/14848778197605.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">CentOS7</h2>

<pre><code class="language-sh">yum install python-setuptools &amp;&amp; easy_install pip
pip install shadowsocks
</code></pre>

<h2 id="toc_1">å¯åŠ¨å‘½ä»¤</h2>

<pre><code class="language-sh">ssserver -p 8836 -k `password` -m rc4-md5
#æˆ–è€…å¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤åœ¨åå°å¯åŠ¨shadowsocksçš„æœåŠ¡ï¼š
ssserver -p 8836 -k `password` -m rc4-md5 -d start
ssserver -p 8836 -k `password` -m rc4-md5 -d stop
</code></pre>

<p><strong>ä¼˜åŒ–ç‰ˆæœ¬</strong><br/>
* åˆ›å»º/etc/shadownsocks.jsoné…ç½®æ–‡ä»¶<br/>
* å†™å…¥é…ç½®:</p>

<pre><code class="language-sh">{
    &quot;server&quot;:&quot;ä½ çš„æœåŠ¡å™¨ipåœ°å€&quot;,
    &quot;server_port&quot;:10088,
    &quot;local_address&quot;: &quot;127.0.0.1&quot;,
    &quot;local_port&quot;:1080,
    &quot;password&quot;:&quot;ä½ è®¾ç½®çš„å¯†ç &quot;,
    &quot;timeout&quot;:300,
    &quot;method&quot;:&quot;aes-256-cfb&quot;,
    &quot;fast_open&quot;: false
}
</code></pre>

<p>ä¼˜åŒ–åçš„å¯åŠ¨å‘½ä»¤:</p>

<pre><code class="language-sh">ssserver -c /etc/shadowsocks.json
#æˆ–è€…åœ¨åå°è¿è¡Œ
ssserver -c /etc/shadowsocks.json -d start
ssserver -c /etc/shadowsocks.json -d stop
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[é‡‘å±±ç¿»è¯‘&æ—¶é—´çš„workflow]]></title>
    <link href="http://blog.cxstars.com/14848776957351.html"/>
    <updated>2017-01-20T10:01:35+08:00</updated>
    <id>http://blog.cxstars.com/14848776957351.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">é¡¹ç›®é“¾æ¥</h2>

<p><a href="https://github.com/star1989/star_workflow">https://github.com/star1989/star_workflow</a></p>

<h2 id="toc_1">é‡‘å±±ç¿»è¯‘</h2>

<h3 id="toc_2"><strong>åŠŸèƒ½:</strong></h3>

<ul>
<li>ä¸­è‹±æ–‡ç¿»è¯‘</li>
<li>éŸ³æ ‡</li>
<li>å‘éŸ³(<strong><em>é»˜è®¤ç¾å¼</em></strong>)</li>
<li>å¤åˆ¶(å½“å‰é€‰ä¸­è¡Œæ–‡æœ¬,å†…å®¹åˆ†ä¸º:éŸ³æ ‡,é‡Šæ„å‡ è¡Œå±•ç¤º,å¯ä»¥è‡ªç”±å¤åˆ¶)

<ul>
<li>æ³¨:å¤åˆ¶çš„åŒæ—¶éƒ½ä¼šæœ‰è¯»éŸ³</li>
<li>å¤åˆ¶ç¤ºä¾‹:<code>am:[stÉ‘r] ,en:[stÉ‘:(r)]</code></li>
</ul></li>
<li>æ·»åŠ å•è¯HOOK</li>
</ul>

<h3 id="toc_3">æŒ‰é”®</h3>

<p><em>dc</em></p>

<blockquote>
<p>å¯¹åº”ä¸­æ–‡çš„å•è¯,è€Œä¸”ä¹Ÿç¦»å·¦æ‰‹è¿‘,æ¯”è¾ƒæ–¹ä¾¿(ä¸»è¦æ˜¯æ‡’)</p>
</blockquote>

<h3 id="toc_4">æ•ˆæœ</h3>

<ul>
<li><p>è‹±æ–‡ç¿»è¯‘<br/>
<img src="http://bimg.cxstars.com/2017-01-20-14848765913701.jpg" alt="è‹±æ–‡ç¿»è¯‘æˆªå›¾"/></p></li>
<li><p>ä¸­æ–‡ç¿»è¯‘<br/>
<img src="http://bimg.cxstars.com/2017-01-21-14850042653066.jpg" alt="ä¸­æ–‡ç¿»è¯‘æˆªå›¾"/></p></li>
<li><p>æ·»åŠ å•è¯HOOK<br/>
<img src="http://bimg.cxstars.com/2017-01-25-14853523310481.jpg" alt="æ·»åŠ å•è¯HOOKå›¾"/></p></li>
<li><p>æ·»åŠ å•è¯é€šçŸ¥<br/>
<img src="http://bimg.cxstars.com/2017-01-25-14853524781043.jpg" alt="æ·»åŠ å•è¯é€šçŸ¥"/></p></li>
</ul>

<h3 id="toc_5">é‡‘å±±API</h3>

<p>é¡¹ç›®é‡Œæˆ‘å·²ç»æ”¾ä¸Šæˆ‘è‡ªå·±çš„API KEY,æ–¹ä¾¿è·Ÿæˆ‘ä¸€æ ·æ‡’çš„é“å‹ä»¬.<br/>
ä¸è¿‡ä¹Ÿå»ºè®®å¤§å®¶è‡ªè¡Œç”³è¯·,éå¸¸æ–¹ä¾¿.<a href="http://open.iciba.com/?c=api">é‡‘å±±è¯éœ¸API</a><br/>
ä¿®æ”¹æ–‡ä»¶<code>jsfy.py</code>:<br/>
<code>app_key = &quot;put your api key&quot;</code></p>

<h2 id="toc_6">time</h2>

<h3 id="toc_7">æ˜¾ç¤ºæ—¶é—´ç›¸å…³çš„ä¿¡æ¯:æ—¥æœŸ,æ—¶é—´,å‘¨å‡ ,ä»Šå¤©æ˜¯ä¸€å¹´ä¸­çš„å¤šå°‘å¤©,æœ¬å‘¨æ˜¯ä¸€å¹´ä¸­çš„å¤šå°‘å‘¨</h3>

<h3 id="toc_8">æŒ‰é”®</h3>

<p><em>now</em></p>

<blockquote>
<p>ä¸ºäº†èŠ‚çº¦macä¸ŠçŠ¶æ€çš„ä½ç½®,è€Œä¸”å¯ä»¥é€šè¿‡workflowå¿«é€Ÿçš„å¤åˆ¶å½“å¤©çš„æ—¶é—´ä¿¡æ¯,æ–¹ä¾¿æˆ‘æ‡’å¾—è¾“TODOé‡Œçš„æ—¥æœŸä¹‹ç±»çš„.åŒæ—¶ä¹Ÿæé†’è‡ªå·±æ—¶é—´é£å¿«,æƒœæ—¶åŠ¡äº‹.</p>
</blockquote>

<h3 id="toc_9">æ•ˆæœ</h3>

<p><img src="http://bimg.cxstars.com/2017-02-01-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-01%2020.57.39.png" alt="nowæˆªå›¾"/></p>

<h2 id="toc_10">å‚è€ƒèµ„æ–™</h2>

<ul>
<li><a href="http://www.deanishe.net/alfred-workflow/">Alfred-Workflow Python</a></li>
<li><a href="https://www.alfredapp.com/help/workflows/">Alfred office help</a></li>
</ul>

<h2 id="toc_11">ToDoList</h2>

<ul>
<li>é‡‘å±±ç¿»è¯‘

<ul>
<li><del>æ·»åŠ å•è¯åˆ°å•è¯æœ¬(v1.3:2017-01-25)</del></li>
<li><del>ä¸­ç¿»è‹±(v1.1:2017-01-21)</del></li>
<li><del>å•è¯é¡ºåºåˆ—è¡¨/å½“å¤©åº”è®°å•è¯åˆ—è¡¨API(2017-02-01)</del></li>
<li>å®‰å“å•è¯APP</li>
<li>æ¯æ—¥ä¸€å¥</li>
</ul></li>
<li>time

<ul>
<li>å†å²ä¸Šçš„ä»Šå¤©</li>
</ul></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pythonè¯­æ³•æ€»ç»“]]></title>
    <link href="http://blog.cxstars.com/14842902733244.html"/>
    <updated>2017-01-13T14:51:13+08:00</updated>
    <id>http://blog.cxstars.com/14842902733244.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">å˜é‡</h2>

<h3 id="toc_1">å‘½ä»¤è§„åˆ™</h3>

<ul>
<li>å¿…é¡»æ˜¯å¤§å°å†™è‹±æ–‡,æ•°å­—å’Œ_çš„ç»„åˆ,ä¸”ä¸èƒ½ç”¨æ•°å­—å¼€å¤´</li>
<li>ä¸ç”¨å£°æ˜,ç›´æ¥ä½¿ç”¨(åŒPHP)</li>
</ul>

<h3 id="toc_2">ç±»å‹</h3>

<ul>
<li>æ•´æ•°</li>
<li>æµ®ç‚¹</li>
<li>å­—ç¬¦ä¸²</li>
<li>å¸ƒå°”</li>
<li>ç©º: None (ä¸0ä¸åŒ)</li>
<li>Tuple : å…ƒç»„,å€¼ä¸å¯å˜æ›´</li>
<li>List : è¡¨,å€¼å¯ä»¥å˜æ›´[ä¸‹é™:ä¸Šé™:æ­¥é•¿]</li>
<li>Dictionary : å­—å…¸</li>
<li>è‡ªå®šä¹‰æ•°æ®ç±»å‹</li>
</ul>

<h2 id="toc_3">è¯­æ³•</h2>

<h3 id="toc_4">ç¼©è¿›</h3>

<p>pythonå¼ºåˆ¶ä½¿ç”¨ç¼©è¿›æ¥è§£æå—ä»£ç .</p>

<h3 id="toc_5">è¿ç®—ç¬¦</h3>

<ul>
<li>æ•°å­¦ : <code>+,-,*,/,**,%</code></li>
<li>åˆ¤æ–­ : <code>==,!=,&gt;,&gt;=,&lt;,&lt;=,in</code></li>
<li>é€»è¾‘ : <code>and,or,not</code></li>
</ul>

<h3 id="toc_6">æ¡ä»¶è¯­å¥</h3>

<pre><code class="language-python">if condition1:
    do1
elif condition2:
    do2
elif condition3:
    do3
else:
    do4
</code></pre>

<h3 id="toc_7">å¾ªç¯</h3>

<p><strong>for</strong></p>

<pre><code class="language-python">for elemnt in list:
    statment
</code></pre>

<p><strong>while</strong></p>

<pre><code class="language-python">while condition:
    statement
</code></pre>

<p><strong>continue</strong><br/>
<strong>break</strong></p>

<span id="more"></span><!-- more -->

<h3 id="toc_8">é”™è¯¯å¤„ç†</h3>

<ul>
<li>å‡½æ•°è¿”å›å€¼</li>
<li>å¼‚å¸¸å¤„ç†</li>
</ul>

<pre><code class="language-python">try:
    do1
except exception1:
    do e1==åªæœ‰exception1æ‰ä¼šè¿›å…¥è¿™é‡Œ==
except exception2:
    do e2
except:
    do default e==é»˜è®¤çš„exceptionå¤„ç†==
else:
    do elsedo==å¦‚æœæ²¡æœ‰exceptionåˆ™è¿›å…¥è¿™é‡Œ==
finally:
    do finallydo==ä¸è®ºæœ‰æ²¡æœ‰å‘ç”Ÿexceptionéƒ½è¦æ‰§è¡Œ==
</code></pre>

<h2 id="toc_9">å‡½æ•°</h2>

<h3 id="toc_10">å®šä¹‰å‡½æ•°</h3>

<p><strong>å®ç°åŠŸèƒ½,é‡å¤åˆ©ç”¨</strong></p>

<pre><code class="language-python">def func_name(a,b,...):
    statement
    return v1,v2,...
</code></pre>

<p><strong>è‹¥æ²¡æœ‰returnæˆ–è€…returnåæ— è¿”å›å€¼æ—¶,å‡½æ•°å°†è‡ªåŠ¨è¿”å›None</strong></p>

<h3 id="toc_11">å‚æ•°ä¼ é€’</h3>

<ul>
<li>æŒ‰é¡ºåºä¼ é€’</li>
<li>å…³é”®å­—ä¼ é€’</li>
<li>å‚æ•°é»˜è®¤å€¼</li>
<li>åŒ…è£¹ä¼ é€’(packing) &amp; è§£åŒ…è£¹(unpacking)</li>
</ul>

<p><strong>å¯æ··ç”¨,æ··ç”¨åŸåˆ™:</strong><em>å…ˆä½ç½®,åå…³é”®å­—,åŒ…è£¹ä½ç½®,åŒ…è£¹å…³é”®å­—</em></p>

<h4 id="toc_12">packing</h4>

<pre><code class="language-python">&gt;&gt;&gt; def pack(*param):
...     print param
&gt;&gt;&gt; pack(1,2,3,4,&quot;abc&quot;)
(1, 2, 3, 4, &#39;abc&#39;)
</code></pre>

<p>å¹³å¸¸åº”ç”¨,å¯ä»¥å¼ºåˆ¶å°†tupleè½¬æ¢æˆlist:</p>

<pre><code class="language-python">&gt;&gt;&gt; def pack2(*param):
...     param = list(param)
...     param[0] = &quot;Hello&quot;
...     param[1] = &quot;Python&quot;
...     print param
&gt;&gt;&gt; pack2(1,2,&quot;end&quot;)
[&#39;Hello&#39;, &#39;Python&#39;, &#39;end&#39;]
</code></pre>

<h4 id="toc_13">unpacking</h4>

<p><code>**param</code></p>

<h3 id="toc_14">å‡½æ•°å¯¹è±¡(lambda)</h3>

<blockquote>
<p>è¿™ç§èƒ½å¤Ÿæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°å«åšã€Œé«˜é˜¶å‡½æ•°ã€ï¼ˆhigher-order functionï¼‰ï¼Œæ˜¯æ¥è‡ªå‡½æ•°å¼ç¼–ç¨‹ï¼ˆfunctional programmingï¼‰çš„æ€æƒ³ã€‚</p>
</blockquote>

<pre><code class="language-python">&gt;&gt;&gt; seq=[1,2,3,4,5]
&gt;&gt;&gt; map(lambda x:x**3, [ x for x in seq ])
[1, 8, 27, 64, 125]
</code></pre>

<p><strong>é«˜é˜¶å‡½æ•°</strong>:<br/>
* filter(function, sequence)ï¼šå¯¹sequenceä¸­çš„itemä¾æ¬¡æ‰§è¡Œfunction(item)ï¼Œå°†æ‰§è¡Œç»“æœä¸ºTrueçš„itemç»„æˆä¸€ä¸ªList/String/Tupleï¼ˆå–å†³äºsequenceçš„ç±»å‹ï¼‰è¿”å›<br/>
* map(function, sequence) ï¼šå¯¹sequenceä¸­çš„itemä¾æ¬¡æ‰§è¡Œfunction(item)ï¼Œè§æ‰§è¡Œç»“æœç»„æˆä¸€ä¸ªListè¿”å›<br/>
* reduce(function, sequence, starting_value)ï¼šå¯¹sequenceä¸­çš„itemé¡ºåºè¿­ä»£è°ƒç”¨functionï¼Œå¦‚æœæœ‰starting_valueï¼Œè¿˜å¯ä»¥ä½œä¸ºåˆå§‹å€¼è°ƒç”¨ï¼Œä¾‹å¦‚å¯ä»¥ç”¨æ¥å¯¹Listæ±‚å’Œ<br/>
* lambdaï¼šè¿™æ˜¯Pythonæ”¯æŒä¸€ç§æœ‰è¶£çš„è¯­æ³•ï¼Œå®ƒå…è®¸ä½ å¿«é€Ÿå®šä¹‰å•è¡Œçš„æœ€å°å‡½æ•°ï¼Œç±»ä¼¼ä¸Cè¯­è¨€ä¸­çš„å®ï¼Œè¿™äº›å«åšlambdaçš„å‡½æ•°ï¼Œæ˜¯ä»LISPå€Ÿç”¨æ¥çš„ï¼Œå¯ä»¥ç”¨åœ¨ä»»ä½•éœ€è¦å‡½æ•°çš„åœ°æ–¹</p>

<p><strong>lambdaä¸defçš„å·®åˆ«</strong></p>

<pre><code class="language-python">map( lambda x: x*x, [y for y in range(10)] )
</code></pre>

<pre><code class="language-python">def sq(x):
    return x * x
map(sq, [y for y in range(10)])
</code></pre>

<h2 id="toc_15">é¢å‘å¯¹è±¡çš„ç±»</h2>

<h3 id="toc_16">å®šä¹‰</h3>

<p><strong>ä½¿ç”¨classå…³é”®å­—å®šä¹‰ä¸€ä¸ªç±»,å¹¶ä¸”ç±»åé¦–å­—æ¯å¤§å†™.</strong></p>

<h3 id="toc_17">è¯­æ³•</h3>

<pre><code class="language-python">class PyClass:
variables
functions
</code></pre>

<h3 id="toc_18">åˆ›å»ºå¯¹è±¡</h3>

<p><code>myClass = PyClass()</code></p>

<h3 id="toc_19">å¼•ç”¨å¯¹è±¡å±æ€§</h3>

<p><code>myClass.attribute</code></p>

<h3 id="toc_20">ä½œç”¨åŸŸ</h3>

<ul>
<li>é€šè¿‡selfè°ƒç”¨ç±»å±æ€§</li>
<li>å¯¹è±¡ç”Ÿæˆæ—¶è‡ªåŠ¨æ‰§è¡Œçš„ç‰¹æ®Šæ–¹æ³•: <code>__init__()</code></li>
<li>ç±»çš„å±æ€§æ˜¯å¯¹æ•°æ®çš„å°è£…,æ–¹æ³•åˆ™æ˜¯å¯¹ç±»çš„è¡Œä¸ºå°è£…</li>
<li>ç±»å±æ€§:

<ol>
<li>å…¬æœ‰å±æ€§.</li>
<li>å†…ç½®å±æ€§:ç”±ç³»ç»Ÿåœ¨å®šä¹‰ç±»çš„æ—¶å€™é»˜è®¤æ·»åŠ ,ç”±å‰åä¸¤ä¸ªä¸‹åˆ’çº¿æ„æˆ<code>__dict__</code>,<code>__module__</code></li>
<li>ç§æœ‰å±æ€§:ä¸èƒ½è¢«ç±»ä»¥å¤–çš„å‡½æ•°è°ƒç”¨.å®šä¹‰æ—¶åœ¨å±æ€§åå‰åŠ <code>__</code> </li>
</ol></li>
<li>æ–¹æ³•ä¹Ÿåˆ†ä¸º<strong>å…¬æœ‰æ–¹æ³•</strong>å’Œ<strong>ç§æœ‰æ–¹æ³•</strong>

<ol>
<li>ç§æœ‰æ–¹æ³•:ä»¥<code>__</code>å®šä¹‰</li>
<li>ç±»æ–¹æ³•:è¢«<code>classmethod()</code>å‡½æ•°å¤„ç†è¿‡çš„å‡½æ•°,æ·»åŠ ç±»è£…é¥°å™¨<code>@classmethod</code></li>
<li>é™æ€æ–¹æ³•:ç­‰äº&quot;å…¨å±€å‡½æ•°&quot;</li>
</ol></li>
</ul>

<pre><code class="language-python">from functools import wraps

class A:
    # Decorator as an instance method
    def decorator1(self, func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            print(&#39;Decorator 1&#39;)
            return func(*args, **kwargs)
        return wrapper

    # Decorator as a class method
    @classmethod
    def decorator2(cls, func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            print(&#39;Decorator 2&#39;)
            return func(*args, **kwargs)
        return wrapper
</code></pre>

<h2 id="toc_21">æ¨¡å—</h2>

<h3 id="toc_22">æ¨¡å—å¯¼å…¥</h3>

<pre><code class="language-python">import mod_name #å¼•å…¥æ¨¡å—
import m as k #å¼•å…¥åé‡å‘½å
from m import func1 #å¼•å…¥mæ¨¡å—çš„func1æ–¹æ³•
from m import * #ä»mä¸­å¼•å…¥æ‰€æœ‰å¯¹è±¡
</code></pre>

<h3 id="toc_23">æ¨¡å—è°ƒç”¨</h3>

<p>mod.obj</p>

<h3 id="toc_24">æ¨¡å—æœç´¢è·¯å¾„</h3>

<ol>
<li>ç¨‹åºæ‰€åœ¨ç›®å½•</li>
<li>æ ‡å‡†åº“çš„å®‰è£…è·¯å¾„</li>
<li>æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡PYTHONPATHçš„è·¯å¾„</li>
</ol>

<h3 id="toc_25">æ„å»ºæ¨¡å—</h3>

<h3 id="toc_26">å¸¸ç”¨æ ‡å‡†åº“</h3>

<ul>
<li>æ­£åˆ™<code>re</code></li>
<li>æ—¶é—´ä¸æ—¥æœŸ<code>time</code> <code>datetime</code></li>
<li>è·¯å¾„ä¸æ–‡ä»¶<code>os.path</code> <code>glob</code></li>
<li>æ–‡ä»¶ç®¡ç† <code>os</code> <code>shutil</code></li>
<li>å­˜å‚¨å¯¹è±¡ <code>pickle</code> <code>cPickle</code></li>
<li>å­è¿›ç¨‹ <code>subprocess</code></li>
<li>ä¿¡å· <code>signal</code></li>
<li>çº¿ç¨‹åŒæ­¥ <code>threading</code></li>
<li>è¿›ç¨‹ä¿¡æ¯ <code>os</code></li>
<li>å¤šè¿›ç¨‹ <code>multiprocessing</code></li>
<li>æ•°å­¦ <code>math</code></li>
<li>éšæœºæ•° <code>random</code></li>
<li>å¾ªç¯å™¨ <code>itertools</code></li>
<li>æ•°æ®åº“ <code>sqlite3</code></li>
<li><a href="https://docs.python.org/2/library">python2 more library</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åœ¨mac miniä¸Šå®‰è£…CentOS7]]></title>
    <link href="http://blog.cxstars.com/14842192746625.html"/>
    <updated>2017-01-12T19:07:54+08:00</updated>
    <id>http://blog.cxstars.com/14842192746625.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">ä¸‹è½½mini iso</h2>

<p><a href="http://isoredirect.centos.org/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1611.iso">CentOS7 mini</a></p>

<h2 id="toc_1">æ ¼å¼åŒ–</h2>

<p><code>hdiutil convert -format UDRW -o ~/Downloads/CentOS-7-x86_64-Minimal-1611.img ~/Downloads/CentOS-7-x86_64-Minimal-1611.iso</code></p>

<p>è¾“å‡º:</p>

<pre><code class="language-shell">æ­£åœ¨è¯»å–Master Boot Recordï¼ˆMBRï¼š0ï¼‰â€¦
æ­£åœ¨è¯»å–CentOS 7 x86_64                 ï¼ˆApple_ISOï¼š1ï¼‰â€¦
æ­£åœ¨è¯»å–ï¼ˆType EFï¼š2ï¼‰â€¦
.
æ­£åœ¨è¯»å–CentOS 7 x86_64                 ï¼ˆApple_ISOï¼š3ï¼‰â€¦
..............................................................................................................................................................................................
å·²è€—æ—¶ï¼š 3.125s
é€Ÿåº¦ï¼š217.6M å­—èŠ‚/ç§’
èŠ‚çœï¼š0.0%
created: /Users/star/Downloads/CentOS-7-x86_64-Minimal-1611.img.dmg
</code></pre>

<span id="more"></span><!-- more -->

<h2 id="toc_2">æŸ¥çœ‹Uç›˜å¹¶å†™å…¥ç³»ç»Ÿ</h2>

<p>æŸ¥çœ‹Uç›˜è®¾å¤‡ä¿¡æ¯:<br/>
<code>diskutil list</code><br/>
è¾“å‡º:</p>

<pre><code class="language-shell">/dev/disk0 (internal, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *500.3 GB   disk0
   1:                        EFI EFI                     209.7 MB   disk0s1
   2:          Apple_CoreStorage Macintosh HD            499.4 GB   disk0s2
   3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3

/dev/disk1 (internal, virtual):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:                            Macintosh HD           +499.1 GB   disk1
                                 Logical Volume on disk0s2
                                 BD5527E2-7278-4078-90AD-0103839D6A6C
                                 Unlocked Encrypted

/dev/disk2 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *4.0 GB     disk2
   1:                 DOS_FAT_32 LDANE                   4.0 GB     disk2s1
</code></pre>

<p>å¸è½½Uç›˜æŒ‚è½½:<br/>
<code>diskutil unmountDisk /dev/disk2</code></p>

<p>è¾“å‡º:<br/>
<code>Unmount of all volumes on disk2 was successful</code></p>

<p>å†™å…¥ç³»ç»Ÿ:<br/>
<code>sudo dd if=~/Downloads/CentOS-7-x86_64-Minimal-1611.img.dmg of=/dev/disk2 bs=1m</code><br/>
åšä¸ªå®‰é™ç­‰å¾…çš„ç¾ç”·å­.</p>

<h2 id="toc_3">è¿›å…¥ç³»ç»Ÿ</h2>

<p>æŒ‰<code>option</code>é”®è¿›å…¥ç•Œé¢åé€‰æ‹©<code>EFI</code>è¿›å…¥ç³»ç»Ÿ.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[swooleå®‰è£…]]></title>
    <link href="http://blog.cxstars.com/14840656639167.html"/>
    <updated>2017-01-11T00:27:43+08:00</updated>
    <id>http://blog.cxstars.com/14840656639167.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">ä¸‹è½½æºç </h2>

<p><a href="https://git.oschina.net/matyhtf/swoole.git">swoole oschina link</a></p>

<h2 id="toc_1">åœ¨macä¸‹ç¼–è¯‘</h2>

<h3 id="toc_2">ç¼–è¯‘swoole</h3>

<pre><code class="language-bash">cd swoole-src
phpize
./configure
make
sudo make install
</code></pre>

<h3 id="toc_3">æ·»åŠ æ‰©å±•è‡³php.ini</h3>

<p><code>extension=/usr/local/php/lib/php/extensions/debug-zts-20131226/swoole.so</code></p>

<h3 id="toc_4">æŸ¥çœ‹phpinfo</h3>

<p><img src="http://ojaief5u9.bkt.clouddn.com/2017-01-11-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-01-07%2018.06.51.png" alt="phpinfo show swoole extension"/></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[swooleå­¦ä¹ è®°å½•]]></title>
    <link href="http://blog.cxstars.com/14840656459705.html"/>
    <updated>2017-01-11T00:27:25+08:00</updated>
    <id>http://blog.cxstars.com/14840656459705.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">å®šæ—¶å™¨</h2>

<p><strong>swoole_timer_tick</strong>é‡å¤æ‰§è¡ŒæŒ‡å®šæ–¹æ³•,<strong>swoole_timer_after</strong>å»¶è¿ŸæŒ‡å®šæ—¶é—´åæ‰§è¡Œ<em>callback method</em></p>

<pre><code class="language-php">$tick_timer_id = swoole_timer_tick(1000,function($timer_id){
       echo &#39;same as setInterval.And this timer id :&#39;.$timer_id.PHP_EOL;
    });
var_dump($tick_timer_id);
swoole_timer_after(2000,function(){
   echo &#39;same as setTimeout&#39;.PHP_EOL;
});
swoole_timer_clear($tick_timer_id);
</code></pre>

<h2 id="toc_1">å¼‚æ­¥ä»»åŠ¡</h2>

<pre><code class="language-php">$serv = new swoole_server(&quot;127.0.0.1&quot;, 9501);
//è®¾ç½®å¼‚æ­¥ä»»åŠ¡çš„å·¥ä½œè¿›ç¨‹æ•°é‡
$serv-&gt;set(array(&#39;task_worker_num&#39; =&gt; 4));
$serv-&gt;on(&#39;receive&#39;, function($serv, $fd, $from_id, $data) {
    //æŠ•é€’å¼‚æ­¥ä»»åŠ¡
    $task_id = $serv-&gt;task($data);
    echo &quot;Dispath AsyncTask: id=${task_id}\n&quot;;
});
//å¤„ç†å¼‚æ­¥ä»»åŠ¡
$serv-&gt;on(&#39;task&#39;, function ($serv, $task_id, $from_id, $data) {
    echo &quot;New AsyncTask[id=$task_id]&quot;.PHP_EOL;
    //è¿”å›ä»»åŠ¡æ‰§è¡Œçš„ç»“æœ
//    $serv-&gt;finish(&quot;$data -&gt; OK&quot;);
});
//å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœ
$serv-&gt;on(&#39;finish&#39;, function ($serv, $task_id, $data) {
    echo &quot;AsyncTask[$task_id] Finish: $data&quot;.PHP_EOL;
});
$serv-&gt;start();
</code></pre>

<h2 id="toc_2">åè®®</h2>

<blockquote>
<p>å› ä¸ºTCPé€šä¿¡æ˜¯æµå¼çš„ï¼Œåœ¨æ¥æ”¶1ä¸ªå¤§æ•°æ®åŒ…æ—¶ï¼Œå¯èƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ªæ•°æ®åŒ…å‘é€ã€‚å¤šæ¬¡Sendåº•å±‚ä¹Ÿå¯èƒ½ä¼šåˆå¹¶æˆä¸€æ¬¡è¿›è¡Œå‘é€ã€‚è¿™é‡Œå°±éœ€è¦2ä¸ªæ“ä½œæ¥è§£å†³ï¼š</p>
</blockquote>

<span id="more"></span><!-- more -->

<p>åˆ†åŒ…ï¼šServeræ”¶åˆ°äº†å¤šä¸ªæ•°æ®åŒ…ï¼Œéœ€è¦æ‹†åˆ†æ•°æ®åŒ…<br/>
åˆåŒ…ï¼šServeræ”¶åˆ°çš„æ•°æ®åªæ˜¯åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦ç¼“å­˜æ•°æ®ï¼Œåˆå¹¶æˆå®Œæ•´çš„åŒ…</p>

<h3 id="toc_3">EOFåè®®</h3>

<p>EOFåè®®å¤„ç†çš„åŸç†æ˜¯æ¯ä¸ªæ•°æ®åŒ…ç»“å°¾åŠ ä¸€ä¸²ç‰¹æ®Šå­—ç¬¦è¡¨ç¤ºåŒ…å·²ç»“æŸã€‚å¦‚memcacheã€ftpã€stmpéƒ½ä½¿ç”¨\r\nä½œä¸ºç»“æŸç¬¦ã€‚å‘é€æ•°æ®æ—¶åªéœ€è¦åœ¨åŒ…æœ«å°¾å¢åŠ \r\nå³å¯ã€‚ä½¿ç”¨EOFåè®®å¤„ç†ï¼Œä¸€å®šè¦ç¡®ä¿æ•°æ®åŒ…ä¸­é—´ä¸ä¼šå‡ºç°EOFï¼Œå¦åˆ™ä¼šé€ æˆåˆ†åŒ…é”™è¯¯ã€‚</p>

<p>åœ¨swoole_serverå’Œswoole_clientçš„ä»£ç ä¸­åªéœ€è¦è®¾ç½®2ä¸ªå‚æ•°å°±å¯ä»¥ä½¿ç”¨EOFåè®®å¤„ç†ã€‚</p>

<pre><code class="language-php">$server-&gt;set(array(
    &#39;open_eof_split&#39; =&gt; true,
    &#39;package_eof&#39; =&gt; &quot;\r\n&quot;,
));
$client-&gt;set(array(
    &#39;open_eof_split&#39; =&gt; true,
    &#39;package_eof&#39; =&gt; &quot;\r\n&quot;,
));
</code></pre>

<h2 id="toc_4">å›ºå®šåŒ…å¤´+åŒ…å¤´åè®®</h2>

<p>åŒ…å¤´ç”±ä¸€ä¸ªå­—æ®µæŒ‡å®šäº†åŒ…ä½“æˆ–æ•´ä¸ªåŒ…çš„é•¿åº¦ï¼Œé•¿åº¦ä¸€èˆ¬æ˜¯ä½¿ç”¨2å­—èŠ‚/4å­—èŠ‚æ•´æ•°æ¥è¡¨ç¤ºã€‚æœåŠ¡å™¨æ”¶åˆ°åŒ…å¤´åï¼Œå¯ä»¥æ ¹æ®é•¿åº¦å€¼æ¥ç²¾ç¡®æ§åˆ¶éœ€è¦å†æ¥æ”¶å¤šå°‘æ•°æ®å°±æ˜¯å®Œæ•´çš„æ•°æ®åŒ…ã€‚<br/>
Swooleçš„Serverå’Œå¼‚æ­¥Clientéƒ½æ˜¯åœ¨<em>onReceive</em>å›è°ƒå‡½æ•°ä¸­å¤„ç†æ•°æ®åŒ…ï¼Œå½“è®¾ç½®äº†åè®®å¤„ç†åï¼Œåªæœ‰æ”¶åˆ°ä¸€ä¸ªå®Œæ•´æ•°æ®åŒ…æ—¶æ‰ä¼šè§¦å‘<em>onReceive</em>äº‹ä»¶ã€‚åŒæ­¥å®¢æˆ·ç«¯åœ¨è®¾ç½®äº†åè®®å¤„ç†åï¼Œè°ƒç”¨ $client-&gt;recv() ä¸å†éœ€è¦ä¼ å…¥é•¿åº¦ï¼Œrecvå‡½æ•°åœ¨æ”¶åˆ°å®Œæ•´æ•°æ®åŒ…æˆ–å‘ç”Ÿé”™è¯¯åè¿”å›ã€‚</p>

<pre><code class="language-php">$server-&gt;set(array(
    &#39;open_length_check&#39; =&gt; true,
    &#39;package_max_length&#39; =&gt; 81920,
    &#39;package_length_type&#39; =&gt; &#39;n&#39;, //see php pack()
    &#39;package_length_offset&#39; =&gt; 0,
    &#39;package_body_offset&#39; =&gt; 2,
));
</code></pre>

<h2 id="toc_5">ç¼–ç¨‹æ³¨æ„äº‹é¡¹</h2>

<ol>
<li>ä¸è¦åœ¨ä»£ç ä¸­æ‰§è¡Œsleepä»¥åŠå…¶ä»–ç¡çœ å‡½æ•°ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡exit/dieæ˜¯å±é™©çš„ï¼Œä¼šå¯¼è‡´workerè¿›ç¨‹é€€å‡º</li>
<li>å¯é€šè¿‡register_shutdown_functionæ¥æ•è·è‡´å‘½é”™è¯¯ï¼Œåœ¨è¿›ç¨‹å¼‚å¸¸é€€å‡ºæ—¶åšä¸€äº›è¯·æ±‚å·¥ä½œï¼Œå…·ä½“å‚çœ‹/wiki/page/305.html</li>
<li>PHPä»£ç ä¸­å¦‚æœæœ‰å¼‚å¸¸æŠ›å‡ºï¼Œå¿…é¡»åœ¨å›è°ƒå‡½æ•°ä¸­è¿›è¡Œtry/catchæ•è·å¼‚å¸¸ï¼Œå¦åˆ™ä¼šå¯¼è‡´å·¥ä½œè¿›ç¨‹é€€å‡º</li>
<li>swooleä¸æ”¯æŒset_exception_handlerï¼Œå¿…é¡»ä½¿ç”¨try/catchæ–¹å¼å¤„ç†å¼‚å¸¸</li>
<li>Workerè¿›ç¨‹ä¸å¾—å…±ç”¨åŒä¸€ä¸ªRedisæˆ–MySQLç­‰ç½‘ç»œæœåŠ¡å®¢æˆ·ç«¯ï¼ŒRedis/MySQLåˆ›å»ºè¿æ¥çš„ç›¸å…³ä»£ç å¯ä»¥æ”¾åˆ°onWorkerStartå›è°ƒå‡½æ•°ä¸­ï¼Œå…·ä½“å‚è€ƒ/wiki/page/325.html</li>
</ol>

<h3 id="toc_6">åŠ è½½æ–‡ä»¶é—®é¢˜</h3>

<p>ç”±äºswooleæ˜¯å¸¸é©»å†…å­˜çš„,æ‰€ä»¥åŠ è½½ç±»/å‡½æ•°å®šä¹‰çš„æ–‡ä»¶åä¸ä¼šé‡Šæ”¾ã€‚å› æ­¤å¼•å…¥ç±»/å‡½æ•°çš„phpæ–‡ä»¶æ—¶å¿…é¡»è¦ä½¿ç”¨<strong>include_once</strong>æˆ–<strong>require_once</strong>ï¼Œå¦ä¼šå‘ç”Ÿ<code>cannot redeclare function/class</code>çš„è‡´å‘½é”™è¯¯ã€‚</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Again,Go!]]></title>
    <link href="http://blog.cxstars.com/14836808084156.html"/>
    <updated>2017-01-06T13:33:28+08:00</updated>
    <id>http://blog.cxstars.com/14836808084156.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">æ²‰é»˜&amp;æ²‰æ·€</h2>

<p>å†æ¬¡è®°å½•è‡ªå·±çš„å¿ƒè·¯å†ç¨‹,ä¸è®ºæ˜¯ç”Ÿæ´»è¿˜æ˜¯å·¥ä½œ.æ€»æ‹…å¿ƒè‡ªå·±ä»€ä¹ˆæ—¶å€™è¿è‡ªå·±éƒ½å¿˜äº†çš„å®¶ä¼™.</p>

<h2 id="toc_1">Mac&amp;Mweb</h2>

<p>ä½¿ç”¨MWebè¿›è¡Œå†™ä½œ.è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„å¿«æ·é”®,é¡ºä¾¿ç†Ÿæ‚‰ä¸€ä¸‹MWeb.</p>

<h2 id="toc_2">MWEB MapKey</h2>

<table>
<thead>
<tr>
<th>å¿«æ·é”®</th>
<th>ä½œç”¨</th>
</tr>
</thead>

<tbody>
<tr>
<td>CTL+1</td>
<td>æ ‡é¢˜1</td>
</tr>
<tr>
<td>CTL+2</td>
<td>æ ‡é¢˜2</td>
</tr>
<tr>
<td>CTL+3</td>
<td>æ ‡é¢˜3</td>
</tr>
<tr>
<td>CTL+4</td>
<td>æ ‡é¢˜4</td>
</tr>
<tr>
<td>CTL+5</td>
<td>æ ‡é¢˜5</td>
</tr>
<tr>
<td>CTL+6</td>
<td>æ ‡é¢˜6</td>
</tr>
<tr>
<td>CMD+B</td>
<td><strong>ç²—ä½“</strong></td>
</tr>
<tr>
<td>CMD+U</td>
<td><u>ä¸‹åˆ’çº¿</u></td>
</tr>
<tr>
<td>CMD+I</td>
<td><em>æ–œä½“</em></td>
</tr>
<tr>
<td>CMD+-</td>
<td><del>åˆ é™¤çº¿</del></td>
</tr>
<tr>
<td>CMD+=</td>
<td><mark>é«˜äº®</mark></td>
</tr>
<tr>
<td>CMD+K</td>
<td>è¡Œå†…ä»£ç </td>
</tr>
<tr>
<td>CMD+/</td>
<td>æ³¨é‡Š</td>
</tr>
<tr>
<td>CMD+.</td>
<td>é˜…è¯»æ›´å¤š</td>
</tr>
<tr>
<td>CTL+U</td>
<td>æ— åºåˆ—è¡¨</td>
</tr>
<tr>
<td>CMD+SFT+O</td>
<td>æœ‰åºåˆ—è¡¨</td>
</tr>
<tr>
<td>CMD+SFT+B</td>
<td>å¼•ç”¨</td>
</tr>
<tr>
<td>CMD+]</td>
<td>å·¦ç§»</td>
</tr>
<tr>
<td>CMD+[</td>
<td>å³ç§»</td>
</tr>
<tr>
<td>CTL+SFT+L</td>
<td>é“¾æ¥</td>
</tr>
<tr>
<td>CTL+SFT+T</td>
<td>è¡¨æ ¼</td>
</tr>
<tr>
<td>CTL+SFT+I</td>
<td>å›¾ç‰‡</td>
</tr>
<tr>
<td>CMD+OPT+I</td>
<td>æ’å…¥æœ¬åœ°å›¾ç‰‡</td>
</tr>
<tr>
<td>CMD+ENT</td>
<td>æ–°æ®µè½</td>
</tr>
<tr>
<td>CMD+SFT+E</td>
<td>ç„¦ç‚¹è‡³ç¼–è¾‘å™¨</td>
</tr>
<tr>
<td>CMD+SFT+F</td>
<td>ç„¦ç‚¹è‡³æœç´¢æ </td>
</tr>
<tr>
<td>CMD+7</td>
<td>å¤§çº²(ç›®å½•)</td>
</tr>
<tr>
<td>CMD+8</td>
<td>æ–‡ä»¶ä¿¡æ¯</td>
</tr>
<tr>
<td>CMD+9</td>
<td>å¯¼å‡º/å‘å¸ƒ</td>
</tr>
<tr>
<td>CMD+E</td>
<td>å¤–éƒ¨æ¨¡å¼(æ‰“å¼€ç°æœ‰çš„æ–‡ä»¶[å¤¹])</td>
</tr>
<tr>
<td>CMD+E</td>
<td>æ–‡æ¡£åº“æ¨¡å¼</td>
</tr>
<tr>
<td>CMD+R</td>
<td>é¢„è§ˆ</td>
</tr>
</tbody>
</table>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[apue-review]]></title>
    <link href="http://blog.cxstars.com/14836103185566.html"/>
    <updated>2017-01-05T17:58:38+08:00</updated>
    <id>http://blog.cxstars.com/14836103185566.html</id>
    <content type="html"><![CDATA[
<blockquote>
<p>ä»ä»Šå¤©(2016-05-26)å¼€å§‹ï¼Œæ–°ä¸€è½®APUEæµè§ˆï¼ŒæœŸæœ›æœ€è¿‘å°±foucså®ƒäº†ï¼ŒåŒäººäº¤æµåæ‰å‘ç°äº†è§£å½’äº†è§£ï¼Œèƒ½ä¸èƒ½è®²æ˜ç™½åˆæ˜¯å¦ä¸€ä¸ªç­‰çº§çš„äº‹äº†ã€‚SO,æ‰“æ€ªæ¶¨ç»éªŒå‡çº§ã€‚ </p>
</blockquote>

<h2 id="toc_0">æºç ç¼–è¯‘</h2>

<p>macä¸‹ç›´æ¥makeå°±okï¼Œubuntuç¨å¾®éº»çƒ¦ä¸€ç‚¹ã€‚<br/>
æˆ‘çœ‹çš„æ˜¯apueç¬¬ä¸‰ç‰ˆè‹±æ–‡ç‰ˆï¼Œå…ˆå°†PDFåˆ†äº«å‡ºæ¥ï¼Œæœ‰éœ€è¦çš„å¯ä»¥ä¸‹ã€‚<br/>
 (apue)[<a href="http://pan.baidu.com/s/1gfsaTk3">http://pan.baidu.com/s/1gfsaTk3</a>] æå–ç <em>ivxs</em> </p>

<h2 id="toc_1">CPUçš„å†…æ ¸æ€å’Œç”¨æˆ·æ€</h2>

<p>åªæœ‰æ‰§è¡Œç¡¬ä»¶å‘½ä»¤æ‰å¯ä»¥ä¾‹CPUåœ¨è¿™ä¸¤ç§çŠ¶æ€é—´æ¥å›åˆ‡æ¢ã€‚æ ¹æœ¬åŒºåˆ«å°±æ˜¯ç”¨æˆ·æ€åªèƒ½æ“ä½œè™šæ‹Ÿå†…å­˜ä¸­è¢«æ ‡è®°ä¸ºç”¨æˆ·å†…å­˜çš„åŒºåŸŸï¼Œè€Œå†…æ ¸æ€åˆ™å¯ä»¥æ“ä½œæ‰€æœ‰å†…å­˜ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_2">æ–‡ä»¶IOæ¨¡å‹</h2>

<p>å°±æœ¬è´¨è€Œè¨€ï¼Œå†…æ ¸åªæä¾›äº†ä¸€ç§æ–‡ä»¶ç±»å‹ï¼šå­—èŠ‚æµåºåˆ—ã€‚<br/>
åœ¨å¤„ç†ç£ç›˜æ–‡ä»¶ã€ç£ç›˜æˆ–è€…ç£å¸¦è®¾å¤‡æ—¶ï¼Œå¯ä»¥é€šè¿‡lseek()ç³»ç»Ÿè°ƒç”¨æ¥éšæœºè®¿é—®ã€‚</p>

<h2 id="toc_3">è¿›ç¨‹çš„å†…å­˜å¸ƒå±€</h2>

<p>é€»è¾‘ä¸Šå°†ä¸€ä¸ªè¿›ç¨‹åˆ†ä¸ºä»¥ä¸‹å‡ æ®µï¼š<br/>
- æ–‡æœ¬ï¼šç¨‹åºçš„æŒ‡ä»¤<br/>
- æ•°æ®ï¼šç¨‹åºä½¿ç”¨çš„é™æ€å˜é‡<br/>
- å †ï¼šç¨‹åºå¯ä»¥ä»è¯¥åŒºåŸŸåŠ¨æ€åˆ†é…é¢å¤–å†…å­˜<br/>
- æ ˆï¼šéšå‡½æ•°è°ƒç”¨ã€è¿”å›è€Œå¢åŠ å‡å°‘çš„ä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œç”¨äºä¸ºå±€éƒ¨å˜é‡å’Œå‡½æ•°è°ƒç”¨é“¾æ¥ä¿¡æ¯åˆ†é…å­˜å‚¨ç©ºé—´</p>

<h2 id="toc_4">å†…å­˜æ˜ å°„</h2>

<ul>
<li>æ–‡ä»¶æ˜ å°„ </li>
<li>åŒ¿åæ˜ å°„</li>
</ul>

<h2 id="toc_5">è¿›ç¨‹é—´é€šè®¯åŠåŒæ­¥ï¼ˆä¸ƒç§æ–¹å¼ï¼‰</h2>

<ul>
<li>ä¿¡å·(signal)ï¼Œè¡¨ç¤ºäº‹ä»¶çš„å‘ç”Ÿ</li>
<li>ç®¡ç†å’ŒFIFOï¼Œç”¨äºåœ¨è¿›ç¨‹é—´ä¼ é€’æ•°æ® </li>
<li>å¥—æ¥å­—ï¼Œå¯ä»¥è·¨ä¸»æœºè¿›ç¨‹é€šè®¯</li>
<li>æ–‡ä»¶é”å®šï¼Œä¸ºé˜²æ­¢å…¶ä»–è¿›ç¨‹è¯»å–æˆ–è€…æ›´æ–°æ–‡ä»¶å†…å®¹ï¼Œå…è®¸æŸè¿›ç¨‹å¯¹æ–‡ä»¶çš„éƒ¨åˆ†åŒºåŸŸåŠ ä»¥é”å®š</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºåœ¨è¿›ç¨‹é—´äº¤æ¢æ¶ˆæ¯(æ•°æ®åŒ…)</li>
<li>ä¿¡å·é‡ï¼ˆsemaphoreï¼‰ï¼Œç”¨æ¥åŒæ­¥è¿›ç¨‹åŠ¨ä½œ</li>
<li>å…±äº«å†…å­˜ï¼Œå…è®¸ä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šè¿›ç¨‹å…±äº«ä¸€å—å†…å­˜ã€‚å½“æŸè¿›ç¨‹æ”¹å˜äº†å…±äº«å†…å­˜çš„å†…å®¹æ—¶ï¼Œå…¶ä»–æ‰€æœ‰è¿›ç¨‹ä¼šç«‹å³äº†è§£åˆ°è¿™ä¸€å˜åŒ–</li>
</ul>

<h2 id="toc_6">è¿›ç¨‹å’Œçº¿ç¨‹å¤åˆ¶</h2>

<p>è¿›ç¨‹ï¼šforkè¿›ç¨‹ä¼šäº§ç”Ÿæ–°çš„è¿›ç¨‹ï¼Œä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„å †ã€æ ˆã€æ•°æ®æ®µã€‚<br/>
çº¿ç¨‹ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæ‰§è¡Œç›¸åŒçš„ç¨‹åºä»£ç ï¼Œå…±äº«åŒä¸€æ•°æ®åŒºåŸŸå’Œå †ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å±äºè‡ªå·±çš„æ ˆï¼Œç”¨æ¥åŠæˆªæœ¬åœ°å˜é‡å’Œå‡½æ•°è°ƒç”¨é“¾æ¥ä¿¡æ¯ã€‚</p>

<h2 id="toc_7">çº¿ç¨‹çš„ä¼˜ç‚¹</h2>

<blockquote>
<p>ååŒçº¿ç¨‹ä¹‹é—´çš„æ•°æ®å…±äº«(é€šè¿‡å…¨å±€å˜é‡)æ›´ä¸ºå®¹æ˜“ï¼Œè€Œä¸”å°±æŸäº›ç®—æ³•è€Œè¨€ï¼Œä»¥å¤šçº¿ç¨‹æ¥å®ç°è¦æ¯”ä¹‹ä»¥å¤šè¿›ç¨‹å®ç°è¦æ›´åŠ è‡ªç„¶ï¼Œè€Œä¸”èƒ½ä»å‹æ¦¨å¤šæ ¸å¤„ç†å™¨çš„è®¡ç®—åŠ›ã€‚</p>
</blockquote>

<h2 id="toc_8">é—®é¢˜</h2>

<ul>
<li>æ–‡ä»¶ç©ºæ´åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿcore dumpï¼Ÿ</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[soa-architecture-overview]]></title>
    <link href="http://blog.cxstars.com/14836102763553.html"/>
    <updated>2017-01-05T17:57:56+08:00</updated>
    <id>http://blog.cxstars.com/14836102763553.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">ä»€ä¹ˆæ˜¯SOA</h2>

<blockquote>
<p>é¢å‘æœåŠ¡çš„ä½“ç³»ç»“æ„ï¼ˆè‹±è¯­ï¼šservice-oriented architectureï¼‰æ˜¯æ„é€ åˆ†å¸ƒå¼è®¡ç®—çš„åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚å®ƒå°†åº”ç”¨ç¨‹åºåŠŸèƒ½ä½œä¸ºæœåŠ¡å‘é€ç»™æœ€ç»ˆç”¨æˆ·æˆ–è€…å…¶ä»–æœåŠ¡ã€‚</p>

<p>ä¼ä¸šç³»ç»Ÿçš„æ¶æ„å¸ˆè®¤ä¸ºSOAèƒ½å¤Ÿå¸®åŠ©ä¸šåŠ¡è¿…é€Ÿå’Œé«˜æ•ˆåœ°å“åº”å˜åŒ–çš„å¸‚åœºæ¡ä»¶. æœåŠ¡å¯¼å‘çš„æ¶æ„åœ¨å®è§‚ï¼ˆæœåŠ¡ï¼‰ä¸Šï¼Œè€Œä¸æ˜¯åœ¨å¾®è§‚ä¸Šï¼ˆå¯¹è±¡ï¼‰å› æ­¤æé«˜äº†é‡å¤ä½¿ç”¨æ€§ã€‚åŒæ—¶ï¼ŒæœåŠ¡å¯¼å‘çš„æ¶æ„å¯ä»¥ç®€åŒ–ä¸ä¼ ç»Ÿç³»ç»Ÿçš„äº’è¿å’Œä½¿ç”¨ã€‚</p>
</blockquote>

<h2 id="toc_1">SOA Principle</h2>

<ul>
<li>å¯é‡å¤ä½¿ç”¨ï¼Œç²’åº¦ï¼Œæ¨¡ç»„æ€§ï¼Œå¯ç»„åˆå‹ï¼Œç‰©ä»¶åŒ–åŸä»¶ï¼Œæ„ä»¶åŒ–ä»¥åŠå…·äº¤äº’æ“ä½œæ€§</li>
<li>ç¬¦åˆå¼€æ”¾æ ‡å‡†ï¼ˆé€šç”¨çš„æˆ–è€…è¡Œä¸šçš„ï¼‰</li>
<li>æœåŠ¡çš„è¯†åˆ«å’Œåˆ†ç±»ï¼Œæä¾›å’Œå‘å¸ƒï¼Œç›‘æ§å’Œè·Ÿè¸ª</li>
</ul>

<span id="more"></span><!-- more -->

<h2 id="toc_2">RPC - Remote Process Call</h2>

<blockquote>
<p>RPCä½¿ç”¨C/Sæ–¹å¼ï¼Œé‡‡ç”¨httpåè®®,å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨è¿”å›ç»“æœã€‚è¿™ä¸ªè¯·æ±‚åŒ…æ‹¬ä¸€ä¸ªå‚æ•°é›†å’Œä¸€ä¸ªæ–‡æœ¬é›†ï¼Œé€šå¸¸å½¢æˆâ€œclassname.methodnameâ€å½¢å¼ã€‚ä¼˜ç‚¹æ˜¯è·¨è¯­è¨€è·¨å¹³å°ï¼ŒCç«¯ã€Sç«¯æœ‰æ›´å¤§çš„ç‹¬ç«‹æ€§ï¼Œç¼ºç‚¹æ˜¯<em>ä¸æ”¯æŒå¯¹è±¡ï¼Œæ— æ³•åœ¨ç¼–è¯‘å™¨æ£€æŸ¥é”™è¯¯ï¼Œåªèƒ½åœ¨è¿è¡ŒæœŸæ£€æŸ¥</em>ã€‚</p>
</blockquote>

<h2 id="toc_3">RMI - Remote Method Ivocation</h2>

<blockquote>
<p>TCPåè®®ã€‚é‡‡ç”¨stubs å’Œ skeletons æ¥è¿›è¡Œè¿œç¨‹å¯¹è±¡(remote object)çš„é€šè®¯ã€‚stub å……å½“è¿œç¨‹å¯¹è±¡çš„å®¢æˆ·ç«¯ä»£ç†ï¼Œæœ‰ç€å’Œè¿œç¨‹å¯¹è±¡ç›¸åŒçš„è¿œç¨‹æ¥å£ï¼Œè¿œç¨‹å¯¹è±¡çš„è°ƒç”¨å®é™…æ˜¯é€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„å®¢æˆ·ç«¯ä»£ç†å¯¹è±¡stubæ¥å®Œæˆçš„ï¼Œé€šè¿‡è¯¥æœºåˆ¶RMIå°±å¥½æ¯”å®ƒæ˜¯æœ¬åœ°å·¥ä½œï¼Œé‡‡ç”¨tcp/ipåè®®ï¼Œå®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨æœåŠ¡ç«¯ä¸Šçš„ä¸€äº›æ–¹æ³•ã€‚ä¼˜ç‚¹æ˜¯å¼ºç±»å‹ï¼Œç¼–è¯‘æœŸå¯æ£€æŸ¥é”™è¯¯ï¼Œç¼ºç‚¹æ˜¯åªèƒ½åŸºäºJAVAè¯­è¨€ï¼Œå®¢æˆ·æœºä¸æœåŠ¡å™¨ç´§è€¦åˆã€‚</p>
</blockquote>

<h2 id="toc_4">Architecture æ¶æ„</h2>

<blockquote>
<p>åˆ†æå°±æ˜¯åšæ­£ç¡®çš„äº‹ï¼Œè®¾è®¡å°±æ˜¯æ­£ç¡®çš„åšäº‹ã€‚æ¶æ„è·Ÿè¯­è¨€è·Ÿå¹³å°å…³ç³»ä¸å¤§ï¼Œæ¯•ç«Ÿæ¶æ„æ˜¯è®¾è®¡è¿‡ç¨‹ä¸­çš„å­è¿‡ç¨‹ï¼Œæˆ‘æƒ³å¦‚æœä½ çš„è®¾è®¡ä¸åˆç†ï¼Œä½ ç”¨ä»»ä½•è¯­è¨€ä»»ä½•å¹³å°éƒ½è§£å†³ä¸äº†é—®é¢˜ã€‚</p>
</blockquote>

<h2 id="toc_5">GRASP - General Responsibility Assignment Software Patternsï¼ˆé€šç”¨èŒè´£åˆ†é…è½¯ä»¶æ¨¡å¼ï¼‰</h2>

<blockquote>
<p>GRASPä¸€å…±åŒ…æ‹¬9ç§æ¨¡å¼ï¼Œå®ƒä»¬æè¿°äº†å¯¹è±¡è®¾è®¡å’ŒèŒè´£åˆ†é…çš„åŸºæœ¬åŸåˆ™ã€‚å¦‚ä½•æŠŠç°å®ä¸–ç•Œçš„ä¸šåŠ¡åŠŸèƒ½æŠ½è±¡æˆå¯¹è±¡ï¼Œå¦‚ä½•å†³å®šä¸€ä¸ªç³»ç»Ÿæœ‰å¤šå°‘å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½åŒ…æ‹¬ä»€ä¹ˆèŒè´£ï¼ŒGRASPæ¨¡å¼ç»™å‡ºäº†æœ€åŸºæœ¬çš„æŒ‡å¯¼åŸåˆ™ã€‚</p>
</blockquote>

<p><em>2016-05-26</em> </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[serverh-on-redis-source-code]]></title>
    <link href="http://blog.cxstars.com/14836102159997.html"/>
    <updated>2017-01-05T17:56:55+08:00</updated>
    <id>http://blog.cxstars.com/14836102159997.html</id>
    <content type="html"><![CDATA[
<h1 id="toc_0">server.h on redis source code</h1>

<h2 id="toc_1">directory</h2>

<ul>
<li><code>src</code>:åŒ…æ‹¬äº†æ‰€æœ‰Redisçš„cå®ç°æºæ–‡ä»¶</li>
<li><code>tests</code>:åŒ…æ‹¬äº†æ‰€æœ‰çš„Rediså•å…ƒæµ‹è¯•æ–‡ä»¶ï¼Œæœ‰Redisã€Redis Clusterã€Redis Sentinelï¼Œä½¿ç”¨tcl(<em>Sentinel</em>)å®ç°</li>
<li><code>deps</code>:åŒ…æ‹¬äº†Redisæ‰€æœ‰è¦ç”¨çš„åº“ï¼Œä½ åªéœ€è¦æä¾›<code>libc</code>å’Œä¸€ä¸ªcç¼–è¯‘å™¨ã€‚<code>deps</code>ä¸‹å¤§å¤šæ•°çš„åŠŸèƒ½éƒ½æ˜¯å¼€å§‹äº<em>Redis</em>ï¼Œä¹Ÿæœ‰ä¸€ä¸ªä¾‹å¤–ï¼š<code>geohash-int</code></li>
</ul>

<h2 id="toc_2">server.h</h2>

<blockquote>
<p>åœ¨Redis3.0çš„unstableåˆ†æ”¯ä¸­å…¨åä¸º<code>redis.h</code>å’Œ<code>redis.c</code>ã€‚æƒ³è¦ç†è§£Redisæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå°±è¦å…ˆç†è§£å®ƒæ‰€ç”¨çš„æ•°æ®ç»“æ„ã€‚<br/>
<code>struct redisServer</code>é‡ŒåŒ…å«äº†æ‰€æœ‰redis serverçš„é…ç½®ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªé‡è¦çš„å­—æ®µï¼š</p>
</blockquote>

<span id="more"></span><!-- more -->

<ul>
<li><code>server.db</code>Redis Databasesæ•°ç»„ï¼Œå­˜å‚¨æ•°æ®çš„åœ°ä¸»</li>
<li><code>server.commands</code>æ˜¯æ‰€æ”¯æŒçš„å‘½ä»¤è¡¨</li>
<li><code>server.clients</code>å·²è¿æ¥serverçš„Redsi Clienté“¾è¡¨</li>
<li><code>server.master</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šå®¢æˆ·ç«¯,å¦‚æœå®ä¾‹æ˜¯ä»æœåŠ¡,åˆ™ä¸ºä¸»æœåŠ¡å™¨çš„å®¢æˆ·ç«¯</li>
</ul>

<blockquote>
<p>å¦ä¸€ä¸ªéå¸¸é‡è¦çš„Redisæ•°æ®ç»“æ„æ˜¯clientçš„å®šä¹‰ï¼Œä»¥å‰å®šä¹‰ä¸ºredisClientã€‚</p>
</blockquote>

<p>è¿™ä¸ªç»“æ„å®šä¹‰äº†è¿™ä¹ˆå¤šå­—æ®µï¼Œè¿™é‡Œåªå±•ç¤ºåªä¸ªé‡è¦çš„å­—ç¬¦ï¼š</p>

<pre><code class="language-c">struct client {
int fd;
sds querybuf;
int argc;
robj \*\*argv;
redisDb \*db;
int flags;
list \*reply;
char buf[PROTO\_REPLY\_CHUNK\_BYTES];
... many other fields ...
}
</code></pre>

<p>clientç»“æ„å®šä¹‰äº†ä¸€ä¸ªå·²è¿æ¥Rediså®¢æˆ·ç«¯ï¼š<br/>
* <code>fd</code>æ˜¯å®¢æˆ·ç«¯çš„socketæè¿°ç¬¦<br/>
* <code>argc</code>å’Œ<code>argv</code>æ˜¯å®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤æ—¶çš„å‚æ•°ï¼Œæ‰§è¡Œæ–¹æ³•å®ç°äº†ç»™å®šRediså‘½ä»¤è¯»å–å‚æ•°ã€‚<br/>
* <code>querybuf</code>æ˜¯ä»å®¢æˆ·ç«¯ç§¯ç´¯çš„è¯·æ±‚ï¼Œå®ƒä»¬å°†è¢«Redis Serveré€šè¿‡Redis protocolè§£æå¹¶æ‰§è¡Œå®¢æˆ·ç«¯å‘½ä»¤çš„å®ç°ã€‚<br/>
* <code>reply</code>å’Œ<code>buf</code>æ˜¯Redis Serveræ‰§è¡Œå‘½ä»¤åè¿”å›ç»™å®¢æˆ·ç«¯çš„åŠ¨æ€ã€é™æ€ç¼“å­˜ã€‚å½“æ–‡ä»¶æè¿°ç¬¦å¯å†™ï¼Œè¿™äº›ç¼“å­˜å°±å¢é‡çš„å†™è¿›socket<br/>
å°±åƒä½ çœ‹åˆ°çš„ï¼Œåœ¨clientç»“æ„ä½“çš„ä¸Šæ–¹ï¼Œå°±æ˜¯å‘½ä»¤å‚æ•°çš„ç»“æ„ä½“<code>robj</code>ã€‚ä¸‹é¢æ˜¯<code>robj</code>çš„æ‰€æœ‰ç»“æ„ï¼Œå®ƒè¢«å®šä¹‰ä¸º<em>Redis Object</em>å¯¹è±¡:</p>

<pre><code class="language-c">typedef struct redisObject {
unsigned type:4;
unsigned encoding:4;
unsigned lru:LRU\_BITS; /*Â lru time (relative to server.lruclock)Â */
int refcount;
void \*ptr;
} robj;

</code></pre>

<p>åŸºæœ¬ä¸Šè¿™ä¸ªç»“æ„å°±å¯ä»¥ä»£è¡¨æ‰€æœ‰Redisçš„åŸºæœ¬æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚strings,lists,sets,sorted,setsç­‰ç­‰ã€‚æœ‰è¶£çš„æ˜¯å®ƒæœ‰ä¸€ä¸ª<code>type</code>å­—æ®µï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“æ˜¯ä¸€ä¸ªä»€ä¹ˆç±»å‹çš„å¯¹è±¡ã€‚<code>refcount</code>å¯ä»¥å…³è”å¥½å‡ ä¸ªåœ°æ–¹çš„åŒä¸€ä¸ªå¯¹è±¡è€Œä¸ç”¨å†é‡æ–°åˆ†é…å†…å­˜ã€‚æœ€å<code>ptr</code>æŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„å®é™…åœ°å€ï¼Œå³ä½¿æ˜¯åŒç±»å‹ï¼Œæ ¹æ®<code>encoding</code>å­—æ®µè¿™ä¸ªå€¼ä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„ã€‚</p>

<p>åœ¨Redisçš„å†…éƒ¨ï¼ŒRedis Objectä½¿ç”¨å¾—éå¸¸å¹¿æ³›ï¼Œç„¶åä¸ºäº†é¿å…è¿‡äºè¿‚å›çš„è®¿é—®æ–¹å¼ï¼Œæœ€è¿‘æˆ‘ä»¬åœ¨è®¸å¤šåœ°æ–¹ä½¿ç”¨å•çº¯çš„åŠ¨æ€å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å°†å®ƒåŒ…è£…è¿›Redis Ojbectã€‚</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[golang send a https request and skip the certificate]]></title>
    <link href="http://blog.cxstars.com/14836098881938.html"/>
    <updated>2017-01-05T17:51:28+08:00</updated>
    <id>http://blog.cxstars.com/14836098881938.html</id>
    <content type="html"><![CDATA[
<p>ä½¿ç”¨<code>crypto/tls</code>åŒ…</p>

<blockquote>
<p>å®˜ç½‘å¯¹åŒ…çš„è¯´æ˜:Package tls partially implements TLS 1.2, as specified in RFC 5246.</p>
</blockquote>

<pre><code class="language-go">package main

import (
        &quot;fmt&quot;
        &quot;net/http&quot;
        &quot;crypto/tls&quot;
       )

func main() {
 tr := &amp;http.Transport{
            TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},

}
        client := &amp;http.Client{Transport: tr}
                _, err := client.Get(&quot;https://golang.org/&quot;)
                    if err != nil {
                                    fmt.Println(err)

                    }

}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[nginxæºç é˜…è¯»]]></title>
    <link href="http://blog.cxstars.com/14836098401416.html"/>
    <updated>2017-01-05T17:50:40+08:00</updated>
    <id>http://blog.cxstars.com/14836098401416.html</id>
    <content type="html"><![CDATA[
<p>@: nginxæºç é˜…è¯»</p>

<h3 id="toc_0">ç›®å½•ç»“æ„</h3>

<ol>
<li><em>auto</em>
è‡ªåŠ¨åŒ–ç¼–è¯‘ç›®å½•,æœ€é‡è¦çš„æ˜¯<strong>configure</strong>æ–‡ä»¶</li>
<li><em>conf</em>
é…ç½®æ¨¡æ¿ç›®å½•</li>
<li><em>contrib</em>
3ä¸ªéšåŒ…å‘è¡Œçš„æ–‡ä»¶åŒ….<strong>Â unicode2nginx</strong>,<strong>vim</strong>,<strong>geo2nginx</strong></li>
<li><em>docs</em>
æ–‡æ¡£</li>
<li><em>misc</em>
C++å…¼å®¹æµ‹è¯•æ–‡ä»¶</li>
<li><em>src</em>
æœ€æœ€æœ€é‡è¦çš„æºç </li>
</ol>

<h3 id="toc_1">autoç›®å½•</h3>

<ol>
<li><strong>configure</strong>
 10 . auto/options
 11 . auto/init
 12 . auto/sources</li>
</ol>

]]></content>
  </entry>
  
</feed>
